(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[744],{6195:e=>{"use strict";e.exports=require("node:buffer")},8491:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ComponentMod:()=>S,default:()=>T});var s={};r.r(s),r.d(s,{POST:()=>p,runtime:()=>d});var i={};r.r(i),r.d(i,{headerHooks:()=>b,originalPathname:()=>w,requestAsyncStorage:()=>v,routeModule:()=>g,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>_});var n=r(8426);r(9996);var a=r(4487),o=r(5459),l=r(723),h=r(6486);let c=process.env.SUPABASE_KEY,u=(0,h.eI)("https://kjywviviybvdhyzhvyry.supabase.co",c),d="edge",f=e=>`${e.role}: ${e.content}`;async function p(e){let t;let r=new Promise(e=>{t=e});u.channel("schema-db-changes").on("postgres_changes",{event:"*",schema:"public",table:"chat_history",filter:"sender=eq.system"},e=>{t(e)}).subscribe();try{let t=await e.json(),s=t.messages??[];s.slice(0,-1).map(f);let i=s[s.length-1].content,n=new Date().toISOString(),{data:a,error:h}=await u.from("chat_history").insert([{content:i,sender:"user",created_at:n}]);if(h)return console.log("error",h),o.Z.json({error:h.message},{status:500});{let e=await r;if(e?.new,"content"in e.new){let t=e.new.content;return console.log("content",t),new l.wn(t)}console.log("content key is not present")}}catch(e){return console.log("error",e),o.Z.json({error:e.message},{status:500})}}let g=new a.Z({definition:{kind:"APP_ROUTE",page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"/Users/merlimar/Projects/AUTOGPT/BBB/Stim/ui/app/api/chat/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:v,staticGenerationAsyncStorage:m,serverHooks:y,headerHooks:b,staticGenerationBailout:_}=g,w="/api/chat/route",S=i,T=n.a.wrap(g)},2287:(e,t,r)=>{"use strict";var s=function(){if("undefined"!=typeof self)return self;if(void 0!==r.g)return r.g;throw Error("unable to locate global object")}();e.exports=t=s.fetch,s.fetch&&(t.default=s.fetch.bind(s)),t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response},6486:(e,t,r)=>{"use strict";r.d(t,{eI:()=>tc});let s=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.t.bind(r,2287,23)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)};class i extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class n extends i{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class a extends i{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class o extends i{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}class l{constructor(e,{headers:t={},customFetch:r}={}){this.url=e,this.headers=t,this.fetch=s(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r,s,i,l,h;return s=this,i=void 0,l=void 0,h=function*(){try{let s;let{headers:i,method:l,body:h}=t,c={};h&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&("undefined"!=typeof Blob&&h instanceof Blob||h instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",s=h):"string"==typeof h?(c["Content-Type"]="text/plain",s=h):"undefined"!=typeof FormData&&h instanceof FormData?s=h:(c["Content-Type"]="application/json",s=JSON.stringify(h)));let u=yield this.fetch(`${this.url}/${e}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),i),body:s}).catch(e=>{throw new n(e)}),d=u.headers.get("x-relay-error");if(d&&"true"===d)throw new a(u);if(!u.ok)throw new o(u);let f=(null!==(r=u.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return{data:"application/json"===f?yield u.json():"application/octet-stream"===f?yield u.blob():"multipart/form-data"===f?yield u.formData():yield u.text(),error:null}}catch(e){return{data:null,error:e}}},new(l||(l=Promise))(function(e,t){function r(e){try{a(h.next(e))}catch(e){t(e)}}function n(e){try{a(h.throw(e))}catch(e){t(e)}}function a(t){var s;t.done?e(t.value):((s=t.value)instanceof l?s:new l(function(e){e(s)})).then(r,n)}a((h=h.apply(s,i||[])).next())})}}var h,c,u,d,f,p,g,v,m,y,b=r(2287),_=r.n(b);class w{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=_():this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=this.fetch,s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,s;let i=null,n=null,a=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(n="text/csv"===this.headers.Accept?t:this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let s=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),h=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");s&&h&&h.length>1&&(a=parseInt(h[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(n)&&(n.length>1?(i={code:"PGRST116",details:`Results contain ${n.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},n=null,a=null,o=406,l="Not Acceptable"):n=1===n.length?n[0]:null)}else{let t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(n=[],i=null,o=200,l="OK")}catch(r){404===e.status&&""===t?(o=204,l="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(s=null==i?void 0:i.details)||void 0===s?void 0:s.includes("Results contain 0 rows"))&&(i=null,o=200,l="OK"),i&&this.shouldThrowOnError)throw i}let h={error:i,data:n,count:a,status:o,statusText:l};return h});return this.shouldThrowOnError||(s=s.catch(e=>{var t,r,s;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(s=null==e?void 0:e.code)&&void 0!==s?s:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}}class S extends w{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s}={}){let i=s?`${s}.order`:"order",n=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${n?`${n},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t}={}){let r=void 0===t?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:r}={}){let s=void 0===r?"offset":`${r}.offset`,i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:n="text"}={}){let a=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),o=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${n}; for="${o}"; options=${a};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class T extends S{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=t.map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";"plain"===s?i="pl":"phrase"===s?i="ph":"websearch"===s&&(i="w");let n=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t}={}){let r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}class x{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){let s=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),new T({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){let s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new T({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){let n=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&n.push(this.headers.Prefer),s&&n.push(`count=${s}`),i||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new T({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new T({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new T({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}let E={"X-Client-Info":"postgrest-js/1.8.4"};class P{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},E),t),this.schemaName=r,this.fetch=s}from(e){let t=new URL(`${this.url}/${e}`);return new x(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new P(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,count:s}={}){let i,n;let a=new URL(`${this.url}/rpc/${e}`);r?(i="HEAD",Object.entries(t).forEach(([e,t])=>{a.searchParams.append(e,`${t}`)})):(i="POST",n=t);let o=Object.assign({},this.headers);return s&&(o.Prefer=`count=${s}`),new T({method:i,url:a,headers:o,schema:this.schemaName,body:n,fetch:this.fetch,allowEmpty:!1})}}var O=r(8104);let C={"X-Client-Info":"realtime-js/2.8.0"};!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(h||(h={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(c||(c={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(u||(u={})),(d||(d={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(f||(f={}));class R{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class k{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let s=t.getUint8(1),i=t.getUint8(2),n=this.HEADER_LENGTH+2,a=r.decode(e.slice(n,n+s));n+=s;let o=r.decode(e.slice(n,n+i));n+=i;let l=JSON.parse(r.decode(e.slice(n,e.byteLength)));return{ref:null,topic:a,event:o,payload:l}}}class A{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0;let e=this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()});"rate limited"===e&&(this.rateLimited=!0)}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(p||(p={}));class j{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=j.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=j.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=j.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){let i=this.cloneDeep(e),n=this.transformState(t),a={},o={};return this.map(i,(e,t)=>{n[e]||(o[e]=t)}),this.map(n,(e,t)=>{let r=i[e];if(r){let s=t.map(e=>e.presence_ref),i=r.map(e=>e.presence_ref),n=t.filter(e=>0>i.indexOf(e.presence_ref)),l=r.filter(e=>0>s.indexOf(e.presence_ref));n.length>0&&(a[e]=n),l.length>0&&(o[e]=l)}else a[e]=t}),this.syncDiff(i,{joins:a,leaves:o},r,s)}static syncDiff(e,t,r,s){let{joins:i,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(t,s)=>{var i;let n=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(s),n.length>0){let r=e[t].map(e=>e.presence_ref),s=n.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...s)}r(t,n,s)}),this.map(n,(t,r)=>{let i=e[t];if(!i)return;let n=r.map(e=>e.presence_ref);i=i.filter(e=>0>n.indexOf(e.presence_ref)),e[t]=i,s(t,i,r),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let s=e[r];return"metas"in s?t[r]=s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(g||(g={}));let I=(e,t,r={})=>{var s;let i=null!==(s=r.skipTypes)&&void 0!==s?s:[];return Object.keys(t).reduce((r,s)=>(r[s]=N(s,e,t,i),r),{})},N=(e,t,r,s)=>{let i=t.find(t=>t.name===e),n=null==i?void 0:i.type,a=r[e];return n&&!s.includes(n)?$(n,a):D(a)},$=(e,t)=>{if("_"===e.charAt(0)){let r=e.slice(1,e.length);return B(t,r)}switch(e){case g.bool:return L(t);case g.float4:case g.float8:case g.int2:case g.int4:case g.int8:case g.numeric:case g.oid:return M(t);case g.json:case g.jsonb:return U(t);case g.timestamp:return H(t);case g.abstime:case g.date:case g.daterange:case g.int4range:case g.int8range:case g.money:case g.reltime:case g.text:case g.time:case g.timestamptz:case g.timetz:case g.tsrange:case g.tstzrange:default:return D(t)}},D=e=>e,L=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},M=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},U=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},B=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,s=e[r],i=e[0];if("{"===i&&"}"===s){let s;let i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch(e){s=i?i.split(","):[]}return s.map(e=>$(t,e))}return e},H=e=>"string"==typeof e?e.replace(" ","T"):e;!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(v||(v={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes"}(m||(m={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(y||(y={}));class q{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=c.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new A(this,u.join,this.params,this.timeout),this.rejoinTimer=new R(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=c.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=c.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=c.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=c.errored,this.rejoinTimer.scheduleTimeout())}),this._on(u.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new j(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:i,presence:n}}=this.params;this._onError(t=>e&&e("CHANNEL_ERROR",t)),this._onClose(()=>e&&e("CLOSED"));let a={},o={broadcast:i,presence:n,postgres_changes:null!==(s=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==s?s:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:o},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:t})=>{var r;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0===t){e&&e("SUBSCRIBED");return}{let s=this.bindings.postgres_changes,i=null!==(r=null==s?void 0:s.length)&&void 0!==r?r:0,n=[];for(let r=0;r<i;r++){let i=s[r],{filter:{event:a,schema:o,table:l,filter:h}}=i,c=t&&t[r];if(c&&c.event===a&&c.schema===o&&c.table===l&&c.filter===h)n.push(Object.assign(Object.assign({},i),{id:c.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=n,e&&e("SUBSCRIBED");return}}).receive("error",t=>{e&&e("CHANNEL_ERROR",Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,i,n;let a=this._push(e.type,e,t.timeout||this.timeout);a.rateLimited&&r("rate limited"),"broadcast"!==e.type||(null===(n=null===(i=null===(s=this.params)||void 0===s?void 0:s.config)||void 0===i?void 0:i.broadcast)||void 0===n?void 0:n.ack)||r("ok"),a.receive("ok",()=>r("ok")),a.receive("timeout",()=>r("timed out"))});{let{event:i,payload:n}=e,a={method:"POST",headers:{apikey:null!==(r=this.socket.accessToken)&&void 0!==r?r:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:n}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);if(e.ok)return"ok";return"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=c.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(u.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let s=new A(this,u.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return(e=(e=e.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,r){let s=new AbortController,i=setTimeout(()=>s.abort(),r),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),n}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new A(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;let n=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:h}=u;if(r&&[a,o,l,h].indexOf(n)>=0&&r!==this._joinRef())return;let c=this._onMessage(n,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(s=this.bindings.postgres_changes)||void 0===s||s.filter(e=>{var t,r,s;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(s=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===s?void 0:s.toLocaleLowerCase())===n}).map(e=>e.callback(c,r)):null===(i=this.bindings[n])||void 0===i||i.filter(e=>{var r,s,i,a,o,l;if(!["broadcast","presence","postgres_changes"].includes(n))return e.type.toLocaleLowerCase()===n;if("id"in e){let n=e.id,a=null===(r=e.filter)||void 0===r?void 0:r.event;return n&&(null===(s=t.ids)||void 0===s?void 0:s.includes(n))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{let r=null===(o=null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:r,commit_timestamp:s,type:i,errors:n}=e;c=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:s,eventType:i,new:{},old:{},errors:n}),this._getPayloadRecords(e))}e.callback(c,r)})}_isClosed(){return this.state===c.closed}_isJoined(){return this.state===c.joined}_isJoining(){return this.state===c.joining}_isLeaving(){return this.state===c.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null===(s=e.type)||void 0===s?void 0:s.toLocaleLowerCase())===r&&q.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(u.close,{},e)}_onError(e){this._on(u.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=c.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=I(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=I(e.columns,e.old_record)),t}}let G=()=>{};class F{constructor(e,t){var s,i;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=C,this.params={},this.timeout=1e4,this.transport=O.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=G,this.conn=null,this.sendBuffer=[],this.serializer=new k,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.t.bind(r,2287,23)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${d.websocket}`,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.transport)&&(this.transport=t.transport),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let n=null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.eventsPerSecond;n&&(this.eventsPerSecondLimitMs=Math.floor(1e3/n));let a=null===(i=null==t?void 0:t.params)||void 0===i?void 0:i.apikey;a&&(this.accessToken=a),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new R(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){!this.conn&&(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case h.connecting:return f.Connecting;case h.open:return f.Open;case h.closing:return f.Closing;default:return f.Closed}}isConnected(){return this.connectionState()===f.Open}channel(e,t={config:{}}){let r=new q(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){let{topic:t,event:r,payload:s,ref:i}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};if(this.log("push",`${t} ${r} (${i})`,s),this.isConnected()){if(["broadcast","presence","postgres_changes"].includes(r)){let e=this._throttle(n)();if(e)return"rate limited"}else n()}else this.sendBuffer.push(n)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(u.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:s,ref:i}=e;(i&&i===this.pendingHeartbeatRef||r===(null==s?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${t} ${r} ${i&&"("+i+")"||""}`,s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,i)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(u.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(e,t=this.eventsPerSecondLimitMs){return()=>!!this.inThrottle||(e(),t>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},t)),!1)}}class V extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function z(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class K extends V{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class J extends V{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let W=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.t.bind(r,2287,23)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},X=()=>(function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{l(s.next(e))}catch(e){n(e)}}function o(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(r.t.bind(r,2287,23))).Response:Response});var Y=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{l(s.next(e))}catch(e){n(e)}}function o(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};let Q=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Z=(e,t)=>Y(void 0,void 0,void 0,function*(){let r=yield X();e instanceof r?e.json().then(r=>{t(new K(Q(r),e.status||500))}).catch(e=>{t(new J(Q(e),e))}):t(new J(Q(e),e))}),ee=(e,t,r,s)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),r))};function et(e,t,r,s,i,n){return Y(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,ee(t,s,i,n)).then(e=>{if(!e.ok)throw e;return(null==s?void 0:s.noResolveJson)?e:e.json()}).then(e=>a(e)).catch(e=>Z(e,o))})})}function er(e,t,r,s){return Y(this,void 0,void 0,function*(){return et(e,"GET",t,r,s)})}function es(e,t,r,s,i){return Y(this,void 0,void 0,function*(){return et(e,"POST",t,s,i,r)})}function ei(e,t,r,s,i){return Y(this,void 0,void 0,function*(){return et(e,"DELETE",t,s,i,r)})}var en=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{l(s.next(e))}catch(e){n(e)}}function o(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};let ea={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eo={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class el{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=W(s)}uploadOrUpdate(e,t,r,s){return en(this,void 0,void 0,function*(){try{let i;let n=Object.assign(Object.assign({},eo),s),a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((i=new FormData).append("cacheControl",n.cacheControl),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(i=r).append("cacheControl",n.cacheControl):(i=r,a["cache-control"]=`max-age=${n.cacheControl}`,a["content-type"]=n.contentType);let o=this._removeEmptyFolders(t),l=this._getFinalPath(o),h=yield this.fetch(`${this.url}/object/${l}`,Object.assign({method:e,body:i,headers:a},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{}));if(h.ok)return{data:{path:o},error:null};{let e=yield h.json();return{data:null,error:e}}}catch(e){if(z(e))return{data:null,error:e};throw e}})}upload(e,t,r){return en(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return en(this,void 0,void 0,function*(){let i=this._removeEmptyFolders(e),n=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${n}`);a.searchParams.set("token",t);try{let e;let t=Object.assign({upsert:eo.upsert},s),n=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,n["cache-control"]=`max-age=${t.cacheControl}`,n["content-type"]=t.contentType);let o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:n});if(o.ok)return{data:{path:i},error:null};{let e=yield o.json();return{data:null,error:e}}}catch(e){if(z(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e){return en(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e),r=yield es(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),s=new URL(this.url+r.url),i=s.searchParams.get("token");if(!i)throw new V("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:i},error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}update(e,t,r){return en(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return en(this,void 0,void 0,function*(){try{let r=yield es(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers});return{data:r,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}copy(e,t){return en(this,void 0,void 0,function*(){try{let r=yield es(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers});return{data:{path:r.Key},error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return en(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield es(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"",a=encodeURI(`${this.url}${i.signedURL}${n}`);return{data:i={signedUrl:a},error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return en(this,void 0,void 0,function*(){try{let s=yield es(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:s.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null})),error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}download(e,t){return en(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=s?`?${s}`:"";try{let t=this._getFinalPath(e),s=yield er(this.fetch,`${this.url}/${r?"render/image/authenticated":"object"}/${t}${i}`,{headers:this.headers,noResolveJson:!0}),n=yield s.blob();return{data:n,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),s=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&s.push(i);let n=void 0!==(null==t?void 0:t.transform),a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&s.push(a);let o=s.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n?"render/image":"object"}/public/${r}${o}`)}}}remove(e){return en(this,void 0,void 0,function*(){try{let t=yield ei(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers});return{data:t,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}list(e,t,r){return en(this,void 0,void 0,function*(){try{let s=Object.assign(Object.assign(Object.assign({},ea),t),{prefix:e||""}),i=yield es(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r);return{data:i,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let eh={"X-Client-Info":"storage-js/2.5.4"};var ec=function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{l(s.next(e))}catch(e){n(e)}}function o(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};class eu{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},eh),t),this.fetch=W(r)}listBuckets(){return ec(this,void 0,void 0,function*(){try{let e=yield er(this.fetch,`${this.url}/bucket`,{headers:this.headers});return{data:e,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}getBucket(e){return ec(this,void 0,void 0,function*(){try{let t=yield er(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers});return{data:t,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return ec(this,void 0,void 0,function*(){try{let r=yield es(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:r,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return ec(this,void 0,void 0,function*(){try{let r=yield function(e,t,r,s,i){return Y(this,void 0,void 0,function*(){return et(e,"PUT",t,s,void 0,r)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:r,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}emptyBucket(e){return ec(this,void 0,void 0,function*(){try{let t=yield es(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers});return{data:t,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}deleteBucket(e){return ec(this,void 0,void 0,function*(){try{let t=yield ei(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers});return{data:t,error:null}}catch(e){if(z(e))return{data:null,error:e};throw e}})}}class ed extends eu{constructor(e,t={},r){super(e,t,r)}from(e){return new el(this.url,this.headers,e,this.fetch)}}let ef="";ef="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let ep={"X-Client-Info":`supabase-js-${ef}/2.38.0`},eg=e=>{let t;return t=e||("undefined"==typeof fetch?_():fetch),(...e)=>t(...e)},ev=()=>"undefined"==typeof Headers?b.Headers:Headers,em=(e,t,r)=>{let s=eg(r),i=ev();return(r,n)=>(function(e,t,r,s){return new(r||(r=Promise))(function(i,n){function a(e){try{l(s.next(e))}catch(e){n(e)}}function o(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){var a;let o=null!==(a=yield t())&&void 0!==a?a:e,l=new i(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),s(r,Object.assign(Object.assign({},n),{headers:l}))})},ey=()=>"undefined"!=typeof document,eb={tested:!1,writable:!1},e_=()=>{if(!ey())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(eb.tested)return eb.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),eb.tested=!0,eb.writable=!0}catch(e){eb.tested=!0,eb.writable=!1}return eb.writable};function ew(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{let e=new URLSearchParams(r.hash.substring(1));e.forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}let eS=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.t.bind(r,2287,23)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},eT=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,ex=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},eE=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},eP=async(e,t)=>{await e.removeItem(t)};class eO{constructor(){this.promise=new eO.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function eC(e){let t=e.split(".");if(3!==t.length)throw Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw Error("JWT is not valid: payload is not in base64url format");let r=t[1];return JSON.parse(function(e){let t,r,s,i,n,a,o;let l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="",c=0;for(e=e.replace("-","+").replace("_","/");c<e.length;)i=l.indexOf(e.charAt(c++)),n=l.indexOf(e.charAt(c++)),a=l.indexOf(e.charAt(c++)),o=l.indexOf(e.charAt(c++)),t=i<<2|n>>4,r=(15&n)<<4|a>>2,s=(3&a)<<6|o,h+=String.fromCharCode(t),64!=a&&0!=r&&(h+=String.fromCharCode(r)),64!=o&&0!=s&&(h+=String.fromCharCode(s));return h}(r))}async function eR(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ek(e){return("0"+e.toString(16)).substr(-2)}function eA(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,ek).join("")}async function ej(e){let t=new TextEncoder,r=t.encode(e),s=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(s);return Array.from(i).map(e=>String.fromCharCode(e)).join("")}async function eI(e){let t="undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder;if(!t)return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;let r=await ej(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}eO.promiseConstructor=Promise;class eN extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function e$(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class eD extends eN{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class eL extends eN{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class eM extends eN{constructor(e,t,r){super(e),this.name=t,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class eU extends eM{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class eB extends eM{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class eH extends eM{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class eq extends eM{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eG extends eM{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eF extends eM{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function eV(e){return e$(e)&&"AuthRetryableFetchError"===e.name}var ez=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)0>t.indexOf(s[i])&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(r[s[i]]=e[s[i]]);return r};let eK=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),eJ=[502,503,504];async function eW(e){let t;if(!eT(e))throw new eF(eK(e),0);if(eJ.includes(e.status))throw new eF(eK(e),e.status);try{t=await e.json()}catch(e){throw new eL(eK(e),e)}throw new eD(eK(t),e.status||500)}let eX=(e,t,r,s)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),r))};async function eY(e,t,r,s){var i;let n=Object.assign({},null==s?void 0:s.headers);(null==s?void 0:s.jwt)&&(n.Authorization=`Bearer ${s.jwt}`);let a=null!==(i=null==s?void 0:s.query)&&void 0!==i?i:{};(null==s?void 0:s.redirectTo)&&(a.redirect_to=s.redirectTo);let o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await eQ(e,t,r+o,{headers:n,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function eQ(e,t,r,s,i,n){let a;let o=eX(t,s,i,n);try{a=await e(r,o)}catch(e){throw console.error(e),new eF(eK(e),0)}if(a.ok||await eW(a),null==s?void 0:s.noResolveJson)return a;try{return await a.json()}catch(e){await eW(e)}}function eZ(e){var t;let r=null;e.access_token&&e.refresh_token&&e.expires_in&&(r=Object.assign({},e),e.expires_at||(r.expires_at=function(e){let t=Math.round(Date.now()/1e3);return t+e}(e.expires_in)));let s=null!==(t=e.user)&&void 0!==t?t:e;return{data:{session:r,user:s},error:null}}function e0(e){var t;let r=null!==(t=e.user)&&void 0!==t?t:e;return{data:{user:r},error:null}}function e1(e){return{data:e,error:null}}function e4(e){let{action_link:t,email_otp:r,hashed_token:s,redirect_to:i,verification_type:n}=e,a=ez(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o=Object.assign({},a);return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:i,verification_type:n},user:o},error:null}}function e3(e){return e}var e2=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)0>t.indexOf(s[i])&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(r[s[i]]=e[s[i]]);return r};class e8{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=eS(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await eY(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(e$(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await eY(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:e0})}catch(e){if(e$(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=e2(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),await eY(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:e4,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(e$(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await eY(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:e0})}catch(e){if(e$(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,s,i,n,a,o;try{let l={nextPage:null,lastPage:0,total:0},h=await eY(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(i=null===(s=null==e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==i?i:""},xform:e3});if(h.error)throw h.error;let c=await h.json(),u=null!==(n=h.headers.get("x-total-count"))&&void 0!==n?n:0,d=null!==(o=null===(a=h.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(e$(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await eY(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:e0})}catch(e){if(e$(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await eY(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:e0})}catch(e){if(e$(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await eY(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:e0})}catch(e){if(e$(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{let{data:t,error:r}=await eY(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(e$(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{let t=await eY(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers});return{data:t,error:null}}catch(e){if(e$(e))return{data:null,error:e};throw e}}}let e5="2.55.0",e6={"X-Client-Info":`gotrue-js/${e5}`},e9={getItem:e=>e_()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{e_()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{e_()&&globalThis.localStorage.removeItem(e)}};function e7(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}globalThis&&e_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug");class te extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let tt={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:e6,flowType:"implicit",debug:!1};async function tr(e,t,r){return await r()}class ts{constructor(e){var t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ts.nextInstanceID,ts.nextInstanceID+=1,this.instanceID>0&&ey()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let r=Object.assign(Object.assign({},tt),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new e8({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=eS(r.fetch),this.lock=r.lock||tr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:e_()?this.storage=e9:(this.memoryStorage={},this.storage=e7(this.memoryStorage)):(this.memoryStorage={},this.storage=e7(this.memoryStorage)),ey()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(t=this.broadcastChannel)||void 0===t||t.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${e5}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{let e=!!ey()&&await this._isPKCEFlow();if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){let{data:t,error:r}=await this._getSessionFromURL(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),await this._removeSession(),{error:r};let{session:s,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(e$(e))return{error:e};return{error:new eL("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var t,r,s;try{let i;if(await this._removeSession(),"email"in e){let{email:r,password:s,options:n}=e,a=null,o=null;if("pkce"===this.flowType){let e=eA();await ex(this.storage,`${this.storageKey}-code-verifier`,e),a=await eI(e),o=e===a?"plain":"s256"}i=await eY(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:r,password:s,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:a,code_challenge_method:o},xform:eZ})}else if("phone"in e){let{phone:t,password:n,options:a}=e;i=await eY(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(r=null==a?void 0:a.data)&&void 0!==r?r:{},channel:null!==(s=null==a?void 0:a.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:eZ})}else throw new eH("You must provide either an email or phone number and a password");let{data:n,error:a}=i;if(a||!n)return{data:{user:null,session:null},error:a};let o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(e$(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if(await this._removeSession(),"email"in e){let{email:r,password:s,options:i}=e;t=await eY(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:eZ})}else if("phone"in e){let{phone:r,password:s,options:i}=e;t=await eY(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:eZ})}else throw new eH("You must provide either an email or phone number and a password");let{data:r,error:s}=t;if(s)return{data:{user:null,session:null},error:s};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new eB};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:{user:r.user,session:r.session},error:s}}catch(e){if(e$(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,s,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await eE(this.storage,`${this.storageKey}-code-verifier`),{data:r,error:s}=await eY(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:eZ});return(await eP(this.storage,`${this.storageKey}-code-verifier`),s)?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:s}):{data:{user:null,session:null},error:new eB}}async signInWithIdToken(e){await this._removeSession();try{let{options:t,provider:r,token:s,access_token:i,nonce:n}=e,a=await eY(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:eZ}),{data:o,error:l}=a;if(l)return{data:{user:null,session:null},error:l};if(!o||!o.session||!o.user)return{data:{user:null,session:null},error:new eB};return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}}catch(e){if(e$(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,s,i,n;try{if(await this._removeSession(),"email"in e){let{email:s,options:i}=e,n=null,a=null;if("pkce"===this.flowType){let e=eA();await ex(this.storage,`${this.storageKey}-code-verifier`,e),n=await eI(e),a=e===n?"plain":"s256"}let{error:o}=await eY(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(r=null==i?void 0:i.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:n,code_challenge_method:a},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:r}=e,{data:a,error:o}=await eY(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(s=null==r?void 0:r.data)&&void 0!==s?s:{},create_user:null===(i=null==r?void 0:r.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(n=null==r?void 0:r.channel)&&void 0!==n?n:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new eH("You must provide either an email or phone number.")}catch(e){if(e$(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let s,i;"email_change"!==e.type&&"phone_change"!==e.type&&await this._removeSession(),"options"in e&&(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(r=e.options)||void 0===r?void 0:r.captchaToken);let{data:n,error:a}=await eY(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:eZ});if(a)throw a;if(!n)throw Error("An error occurred on token verification.");let o=n.session,l=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(e$(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,s;try{return await this._removeSession(),await eY(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:e1})}catch(e){if(e$(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new eU;let{error:s}=await eY(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(e$(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{"email_change"!=e.type&&"phone_change"!=e.type&&await this._removeSession();let t=`${this.url}/resend`;if("email"in e){let{email:r,type:s,options:i}=e,{error:n}=await eY(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){let{phone:r,type:s,options:i}=e,{data:n,error:a}=await eY(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:a}}throw new eH("You must provide either an email or phone number and a type")}catch(e){if(e$(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await eE(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r)return{data:{session:e},error:null};let{session:s,error:i}=await this._callRefreshToken(e.refresh_token);if(i)return{data:{session:null},error:i};return{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await eY(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:e0});return await this._useSession(async e=>{var t,r;let{data:s,error:i}=e;if(i)throw i;return await eY(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(t=s.session)||void 0===t?void 0:t.access_token)&&void 0!==r?r:void 0,xform:e0})})}catch(e){if(e$(e))return{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new eU;let n=s.session,a=null,o=null;if("pkce"===this.flowType&&null!=e.email){let e=eA();await ex(this.storage,`${this.storageKey}-code-verifier`,e),a=await eI(e),o=e===a?"plain":"s256"}let{data:l,error:h}=await eY(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:n.access_token,xform:e0});if(h)throw h;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}})}catch(e){if(e$(e))return{data:{user:null},error:e};throw e}}_decodeJWT(e){return eC(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new eU;let t=Date.now()/1e3,r=t,s=!0,i=null,n=eC(e.access_token);if(n.exp&&(s=(r=n.exp)<=t),s){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};i=t}else{let{data:s,error:n}=await this._getUser(e.access_token);if(n)throw n;i={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(e$(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:s,error:i}=t;if(i)throw i;e=null!==(r=s.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new eU;let{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(e$(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e){try{if(!ey())throw new eq("No browser detected.");if("implicit"!==this.flowType||this._isImplicitGrantFlow()){if("pkce"==this.flowType&&!e)throw new eG("Not a valid PKCE flow url.")}else throw new eq("Not a valid implicit grant flow url.");let t=ew(window.location.href);if(e){if(!t.code)throw new eG("No code detected.");let{data:e,error:r}=await this._exchangeCodeForSession(t.code);if(r)throw r;let s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:e.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new eq(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});let{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:n,expires_in:a,expires_at:o,token_type:l}=t;if(!i||!a||!n||!l)throw new eq("No session defined in URL");let h=Math.round(Date.now()/1e3),c=parseInt(a),u=h+c;o&&(u=parseInt(o));let d=u-h;1e3*d<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${c}s`);let f=u-c;h-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,h):h-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",f,u,h);let{data:p,error:g}=await this._getUser(i);if(g)throw g;let v={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:c,expires_at:u,refresh_token:n,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:t.type},error:null}}catch(e){if(e$(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantFlow(){let e=ew(window.location.href);return!!(ey()&&(e.access_token||e.error_description))}async _isPKCEFlow(){let e=ew(window.location.href),t=await eE(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:s,error:i}=t;if(i)return{error:i};let n=null===(r=s.session)||void 0===r?void 0:r.access_token;if(n){let{error:t}=await this.admin.signOut(n,e);if(t&&!(e$(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await eP(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{let{data:{session:s},error:i}=t;if(i)throw i;await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(t){await (null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;if("pkce"===this.flowType){let e=eA();await ex(this.storage,`${this.storageKey}-code-verifier`,e),r=await eI(e),s=e===r?"plain":"s256"}try{return await eY(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(e$(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{let r=Date.now();return await function(e,t){let r=new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{let s=await e(i);if(!t(i,null,s)){r(s);return}}catch(e){if(!t(i,e)){s(e);return}}})()});return r}(async r=>(await eR(200*r),this._debug(t,"refreshing attempt",r),await eY(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:eZ})),(e,t,s)=>s&&s.error&&eV(s.error)&&Date.now()+(e+1)*200-r<3e4)}catch(e){if(this._debug(t,"error",e),e$(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),ey()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let r=await eE(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),null!==r&&await this._removeSession();return}let s=Math.round(Date.now()/1e3),i=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)<s+10;if(this._debug(t,`session has${i?"":" not"} expired with margin of 10s`),i){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),eV(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(t,"error",e),console.error(e);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new eU;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new eO;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new eU;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let s={session:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(e){if(this._debug(s,"error",e),e$(e)){let r={session:null,error:e};return null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){let s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let s=[],i=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){s.push(e)}});if(await Promise.all(i),s.length>0){for(let e=0;e<s.length;e+=1)console.error(s[e]);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await this._persistSession(e)}_persistSession(e){return this._debug("#_persistSession()",e),ex(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await eP(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ey()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let s=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof te)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ey()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t){let r=[`provider=${encodeURIComponent(e)}`];if((null==t?void 0:t.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),(null==t?void 0:t.scopes)&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),"pkce"===this.flowType){let e=eA();await ex(this.storage,`${this.storageKey}-code-verifier`,e);let t=await eI(e),s=e===t?"plain":"s256";this._debug("PKCE","code verifier",`${e.substring(0,5)}...`,"code challenge",t,"method",s);let i=new URLSearchParams({code_challenge:`${encodeURIComponent(t)}`,code_challenge_method:`${encodeURIComponent(s)}`});r.push(i.toString())}if(null==t?void 0:t.queryParams){let e=new URLSearchParams(t.queryParams);r.push(e.toString())}return`${this.url}/authorize?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:s,error:i}=t;return i?{data:null,error:i}:await eY(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})})}catch(e){if(e$(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;let{data:i,error:n}=t;if(n)return{data:null,error:n};let{data:a,error:o}=await eY(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:((null===(s=null==a?void 0:a.totp)||void 0===s?void 0:s.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(e){if(e$(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:s,error:i}=t;if(i)return{data:null,error:i};let{data:n,error:a}=await eY(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:a})})}catch(e){if(e$(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:s,error:i}=t;return i?{data:null,error:i}:await eY(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})})}catch(e){if(e$(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],s=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let n=this._decodeJWT(s.access_token),a=null;n.aal&&(a=n.aal);let o=a,l=null!==(r=null===(t=s.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[];l.length>0&&(o="aal2");let h=n.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:h},error:null}}))}}ts.nextInstanceID=0;class ti extends ts{constructor(e){super(e)}}let tn={headers:ep},ta={schema:"public"},to={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},tl={};class th{constructor(e,t,r){var s,i,n,a,o,l,h,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let u=e.replace(/\/$/,"");this.realtimeUrl=`${u}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${u}/auth/v1`,this.storageUrl=`${u}/storage/v1`,this.functionsUrl=`${u}/functions/v1`;let d=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,f={db:ta,realtime:tl,auth:Object.assign(Object.assign({},to),{storageKey:d}),global:tn},p=function(e,t){let{db:r,auth:s,realtime:i,global:n}=e,{db:a,auth:o,realtime:l,global:h}=t;return{db:Object.assign(Object.assign({},a),r),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},h),n)}}(null!=r?r:{},f);this.storageKey=null!==(i=null===(s=p.auth)||void 0===s?void 0:s.storageKey)&&void 0!==i?i:"",this.headers=null!==(a=null===(n=p.global)||void 0===n?void 0:n.headers)&&void 0!==a?a:{},this.auth=this._initSupabaseAuthClient(null!==(o=p.auth)&&void 0!==o?o:{},this.headers,null===(l=p.global)||void 0===l?void 0:l.fetch),this.fetch=em(t,this._getAccessToken.bind(this),null===(h=p.global)||void 0===h?void 0:h.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},p.realtime)),this.rest=new P(`${u}/rest/v1`,{headers:this.headers,schema:null===(c=p.db)||void 0===c?void 0:c.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new l(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ed(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,s,i,n;return r=this,s=void 0,i=void 0,n=function*(){let{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null},new(i||(i=Promise))(function(e,t){function a(e){try{l(n.next(e))}catch(e){t(e)}}function o(e){try{l(n.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(a,o)}l((n=n.apply(r,s||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:n,debug:a},o,l){let h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ti({url:this.authUrl,headers:Object.assign(Object.assign({},h),o),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:n,debug:a,fetch:l})}_initRealtimeClient(e){return new F(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.realtime.setAuth(null!=r?r:null),this.changedAccessToken=r):"SIGNED_OUT"===e&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}let tc=(e,t,r)=>new th(e,t,r)},4178:e=>{"use strict";var t=function(){if("object"==typeof self&&self)return self;throw Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{if(!__global__)return t();return __global__}finally{delete Object.prototype.__global__}}()},3928:e=>{"use strict";var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,n={};function a(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`].filter(Boolean);return`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}; ${r.join("; ")}`}function o(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[s,i]=[r.slice(0,e),r.slice(e+1)];try{t.set(s,decodeURIComponent(null!=i?i:"true"))}catch{}}return t}((e,r)=>{for(var s in r)t(e,s,{get:r[s],enumerable:!0})})(n,{RequestCookies:()=>h,ResponseCookies:()=>c}),e.exports=((e,n,a,o)=>{if(n&&"object"==typeof n||"function"==typeof n)for(let a of s(n))i.call(e,a)||void 0===a||t(e,a,{get:()=>n[a],enumerable:!(o=r(n,a))||o.enumerable});return e})(t({},"__esModule",{value:!0}),n);var l=["strict","lax","none"],h=class{constructor(e){this._parsed=new Map,this._headers=e;let t=e.get("cookie");if(t){let e=o(t);for(let[t,r]of e)this._parsed.set(t,{name:t,value:r})}}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let s="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===s).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,s=this._parsed;return s.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(s).map(([e,t])=>a(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>a(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},c=class{constructor(e){var t,r,s;this._parsed=new Map,this._headers=e;let i=null!=(s=null!=(r=null==(t=e.getAll)?void 0:t.call(e,"set-cookie"))?r:e.get("set-cookie"))?s:[],n=Array.isArray(i)?i:function(e){if(!e)return[];var t,r,s,i,n,a=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,n=!1;l();)if(","===(r=e.charAt(o))){for(s=o,o+=1,l(),i=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(n=!0,o=i,a.push(e.substring(t,s)),t=o):o=s+1}else o+=1;(!n||o>=e.length)&&a.push(e.substring(t,e.length))}return a}(i);for(let e of n){let t=function(e){var t;if(!e)return;let[[r,s],...i]=o(e),{domain:n,expires:a,httponly:h,maxage:c,path:u,samesite:d,secure:f}=Object.fromEntries(i.map(([e,t])=>[e.toLowerCase(),t])),p={name:r,value:decodeURIComponent(s),domain:n,...a&&{expires:new Date(a)},...h&&{httpOnly:!0},..."string"==typeof c&&{maxAge:Number(c)},path:u,...d&&{sameSite:(t=(t=d).toLowerCase(),l.includes(t)?t:void 0)},...f&&{secure:!0}};return function(e){let t={};for(let r in e)e[r]&&(t[r]=e[r]);return t}(p)}(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let s="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===s)}set(...e){let[t,r,s]=1===e.length?[e[0].name,e[0].value,e[0]]:e,i=this._parsed;return i.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...s})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=a(r);t.append("set-cookie",e)}}(i,this._headers),this}delete(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this.set({name:t,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(a).join("; ")}}},5049:(e,t,r)=>{"use strict";(()=>{var t={339:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;let s=r(44),i=r(38),n=r(741),a="context",o=new s.NoopContextManager;class l{constructor(){}static getInstance(){return this._instance||(this._instance=new l),this._instance}setGlobalContextManager(e){return(0,i.registerGlobal)(a,e,n.DiagAPI.instance())}active(){return this._getContextManager().active()}with(e,t,r,...s){return this._getContextManager().with(e,t,r,...s)}bind(e,t){return this._getContextManager().bind(e,t)}_getContextManager(){return(0,i.getGlobal)(a)||o}disable(){this._getContextManager().disable(),(0,i.unregisterGlobal)(a,n.DiagAPI.instance())}}t.ContextAPI=l},741:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagAPI=void 0;let s=r(144),i=r(871),n=r(133),a=r(38);class o{constructor(){function e(e){return function(...t){let r=(0,a.getGlobal)("diag");if(r)return r[e](...t)}}let t=this;t.setLogger=(e,r={logLevel:n.DiagLogLevel.INFO})=>{var s,o,l;if(e===t){let e=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(s=e.stack)&&void 0!==s?s:e.message),!1}"number"==typeof r&&(r={logLevel:r});let h=(0,a.getGlobal)("diag"),c=(0,i.createLogLevelDiagLogger)(null!==(o=r.logLevel)&&void 0!==o?o:n.DiagLogLevel.INFO,e);if(h&&!r.suppressOverrideMessage){let e=null!==(l=Error().stack)&&void 0!==l?l:"<failed to generate stacktrace>";h.warn(`Current logger will be overwritten from ${e}`),c.warn(`Current logger will overwrite one already registered from ${e}`)}return(0,a.registerGlobal)("diag",c,t,!0)},t.disable=()=>{(0,a.unregisterGlobal)("diag",t)},t.createComponentLogger=e=>new s.DiagComponentLogger(e),t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}static instance(){return this._instance||(this._instance=new o),this._instance}}t.DiagAPI=o},128:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsAPI=void 0;let s=r(333),i=r(38),n=r(741),a="metrics";class o{constructor(){}static getInstance(){return this._instance||(this._instance=new o),this._instance}setGlobalMeterProvider(e){return(0,i.registerGlobal)(a,e,n.DiagAPI.instance())}getMeterProvider(){return(0,i.getGlobal)(a)||s.NOOP_METER_PROVIDER}getMeter(e,t,r){return this.getMeterProvider().getMeter(e,t,r)}disable(){(0,i.unregisterGlobal)(a,n.DiagAPI.instance())}}t.MetricsAPI=o},930:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;let s=r(38),i=r(600),n=r(625),a=r(377),o=r(701),l=r(741),h="propagation",c=new i.NoopTextMapPropagator;class u{constructor(){this.createBaggage=o.createBaggage,this.getBaggage=a.getBaggage,this.getActiveBaggage=a.getActiveBaggage,this.setBaggage=a.setBaggage,this.deleteBaggage=a.deleteBaggage}static getInstance(){return this._instance||(this._instance=new u),this._instance}setGlobalPropagator(e){return(0,s.registerGlobal)(h,e,l.DiagAPI.instance())}inject(e,t,r=n.defaultTextMapSetter){return this._getGlobalPropagator().inject(e,t,r)}extract(e,t,r=n.defaultTextMapGetter){return this._getGlobalPropagator().extract(e,t,r)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,s.unregisterGlobal)(h,l.DiagAPI.instance())}_getGlobalPropagator(){return(0,s.getGlobal)(h)||c}}t.PropagationAPI=u},967:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;let s=r(38),i=r(414),n=r(994),a=r(542),o=r(741),l="trace";class h{constructor(){this._proxyTracerProvider=new i.ProxyTracerProvider,this.wrapSpanContext=n.wrapSpanContext,this.isSpanContextValid=n.isSpanContextValid,this.deleteSpan=a.deleteSpan,this.getSpan=a.getSpan,this.getActiveSpan=a.getActiveSpan,this.getSpanContext=a.getSpanContext,this.setSpan=a.setSpan,this.setSpanContext=a.setSpanContext}static getInstance(){return this._instance||(this._instance=new h),this._instance}setGlobalTracerProvider(e){let t=(0,s.registerGlobal)(l,this._proxyTracerProvider,o.DiagAPI.instance());return t&&this._proxyTracerProvider.setDelegate(e),t}getTracerProvider(){return(0,s.getGlobal)(l)||this._proxyTracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}disable(){(0,s.unregisterGlobal)(l,o.DiagAPI.instance()),this._proxyTracerProvider=new i.ProxyTracerProvider}}t.TraceAPI=h},377:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBaggage=t.setBaggage=t.getActiveBaggage=t.getBaggage=void 0;let s=r(339),i=r(421),n=(0,i.createContextKey)("OpenTelemetry Baggage Key");function a(e){return e.getValue(n)||void 0}t.getBaggage=a,t.getActiveBaggage=function(){return a(s.ContextAPI.getInstance().active())},t.setBaggage=function(e,t){return e.setValue(n,t)},t.deleteBaggage=function(e){return e.deleteValue(n)}},496:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaggageImpl=void 0;class r{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){let t=this._entries.get(e);if(t)return Object.assign({},t)}getAllEntries(){return Array.from(this._entries.entries()).map(([e,t])=>[e,t])}setEntry(e,t){let s=new r(this._entries);return s._entries.set(e,t),s}removeEntry(e){let t=new r(this._entries);return t._entries.delete(e),t}removeEntries(...e){let t=new r(this._entries);for(let r of e)t._entries.delete(r);return t}clear(){return new r}}t.BaggageImpl=r},817:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataSymbol=void 0,t.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},701:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataFromString=t.createBaggage=void 0;let s=r(741),i=r(496),n=r(817),a=s.DiagAPI.instance();t.createBaggage=function(e={}){return new i.BaggageImpl(new Map(Object.entries(e)))},t.baggageEntryMetadataFromString=function(e){return"string"!=typeof e&&(a.error(`Cannot create baggage metadata from unknown type: ${typeof e}`),e=""),{__TYPE__:n.baggageEntryMetadataSymbol,toString:()=>e}}},388:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.context=void 0;let s=r(339);t.context=s.ContextAPI.getInstance()},44:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;let s=r(421);t.NoopContextManager=class{active(){return s.ROOT_CONTEXT}with(e,t,r,...s){return t.call(r,...s)}bind(e,t){return t}enable(){return this}disable(){return this}}},421:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_CONTEXT=t.createContextKey=void 0,t.createContextKey=function(e){return Symbol.for(e)};class r{constructor(e){let t=this;t._currentContext=e?new Map(e):new Map,t.getValue=e=>t._currentContext.get(e),t.setValue=(e,s)=>{let i=new r(t._currentContext);return i._currentContext.set(e,s),i},t.deleteValue=e=>{let s=new r(t._currentContext);return s._currentContext.delete(e),s}}}t.ROOT_CONTEXT=new r},920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.diag=void 0;let s=r(741);t.diag=s.DiagAPI.instance()},144:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagComponentLogger=void 0;let s=r(38);function i(e,t,r){let i=(0,s.getGlobal)("diag");if(i)return r.unshift(t),i[e](...r)}t.DiagComponentLogger=class{constructor(e){this._namespace=e.namespace||"DiagComponentLogger"}debug(...e){return i("debug",this._namespace,e)}error(...e){return i("error",this._namespace,e)}info(...e){return i("info",this._namespace,e)}warn(...e){return i("warn",this._namespace,e)}verbose(...e){return i("verbose",this._namespace,e)}}},689:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagConsoleLogger=void 0;let r=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];t.DiagConsoleLogger=class{constructor(){for(let e=0;e<r.length;e++)this[r[e].n]=function(e){return function(...t){if(console){let r=console[e];if("function"!=typeof r&&(r=console.log),"function"==typeof r)return r.apply(console,t)}}}(r[e].c)}}},871:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogLevelDiagLogger=void 0;let s=r(133);t.createLogLevelDiagLogger=function(e,t){function r(r,s){let i=t[r];return"function"==typeof i&&e>=s?i.bind(t):function(){}}return e<s.DiagLogLevel.NONE?e=s.DiagLogLevel.NONE:e>s.DiagLogLevel.ALL&&(e=s.DiagLogLevel.ALL),t=t||{},{error:r("error",s.DiagLogLevel.ERROR),warn:r("warn",s.DiagLogLevel.WARN),info:r("info",s.DiagLogLevel.INFO),debug:r("debug",s.DiagLogLevel.DEBUG),verbose:r("verbose",s.DiagLogLevel.VERBOSE)}}},133:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagLogLevel=void 0,function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(t.DiagLogLevel||(t.DiagLogLevel={}))},38:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterGlobal=t.getGlobal=t.registerGlobal=void 0;let s=r(966),i=r(520),n=r(565),a=i.VERSION.split(".")[0],o=Symbol.for(`opentelemetry.js.api.${a}`),l=s._globalThis;t.registerGlobal=function(e,t,r,s=!1){var n;let a=l[o]=null!==(n=l[o])&&void 0!==n?n:{version:i.VERSION};if(!s&&a[e]){let t=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${e}`);return r.error(t.stack||t.message),!1}if(a.version!==i.VERSION){let t=Error(`@opentelemetry/api: Registration of version v${a.version} for ${e} does not match previously registered API v${i.VERSION}`);return r.error(t.stack||t.message),!1}return a[e]=t,r.debug(`@opentelemetry/api: Registered a global for ${e} v${i.VERSION}.`),!0},t.getGlobal=function(e){var t,r;let s=null===(t=l[o])||void 0===t?void 0:t.version;if(s&&(0,n.isCompatible)(s))return null===(r=l[o])||void 0===r?void 0:r[e]},t.unregisterGlobal=function(e,t){t.debug(`@opentelemetry/api: Unregistering a global for ${e} v${i.VERSION}.`);let r=l[o];r&&delete r[e]}},565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCompatible=t._makeCompatibilityCheck=void 0;let s=r(520),i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function n(e){let t=new Set([e]),r=new Set,s=e.match(i);if(!s)return()=>!1;let n={major:+s[1],minor:+s[2],patch:+s[3],prerelease:s[4]};if(null!=n.prerelease)return function(t){return t===e};function a(e){return r.add(e),!1}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;let s=e.match(i);if(!s)return a(e);let o={major:+s[1],minor:+s[2],patch:+s[3],prerelease:s[4]};return null!=o.prerelease||n.major!==o.major?a(e):0===n.major?n.minor===o.minor&&n.patch<=o.patch?(t.add(e),!0):a(e):n.minor<=o.minor?(t.add(e),!0):a(e)}}t._makeCompatibilityCheck=n,t.isCompatible=n(s.VERSION)},934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.metrics=void 0;let s=r(128);t.metrics=s.MetricsAPI.getInstance()},28:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValueType=void 0,function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(t.ValueType||(t.ValueType={}))},962:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopMeter=t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=t.NOOP_OBSERVABLE_GAUGE_METRIC=t.NOOP_OBSERVABLE_COUNTER_METRIC=t.NOOP_UP_DOWN_COUNTER_METRIC=t.NOOP_HISTOGRAM_METRIC=t.NOOP_COUNTER_METRIC=t.NOOP_METER=t.NoopObservableUpDownCounterMetric=t.NoopObservableGaugeMetric=t.NoopObservableCounterMetric=t.NoopObservableMetric=t.NoopHistogramMetric=t.NoopUpDownCounterMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;class r{constructor(){}createHistogram(e,r){return t.NOOP_HISTOGRAM_METRIC}createCounter(e,r){return t.NOOP_COUNTER_METRIC}createUpDownCounter(e,r){return t.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(e,r){return t.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(e,r){return t.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(e,r){return t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(e,t){}removeBatchObservableCallback(e){}}t.NoopMeter=r;class s{}t.NoopMetric=s;class i extends s{add(e,t){}}t.NoopCounterMetric=i;class n extends s{add(e,t){}}t.NoopUpDownCounterMetric=n;class a extends s{record(e,t){}}t.NoopHistogramMetric=a;class o{addCallback(e){}removeCallback(e){}}t.NoopObservableMetric=o;class l extends o{}t.NoopObservableCounterMetric=l;class h extends o{}t.NoopObservableGaugeMetric=h;class c extends o{}t.NoopObservableUpDownCounterMetric=c,t.NOOP_METER=new r,t.NOOP_COUNTER_METRIC=new i,t.NOOP_HISTOGRAM_METRIC=new a,t.NOOP_UP_DOWN_COUNTER_METRIC=new n,t.NOOP_OBSERVABLE_COUNTER_METRIC=new l,t.NOOP_OBSERVABLE_GAUGE_METRIC=new h,t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new c,t.createNoopMeter=function(){return t.NOOP_METER}},333:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;let s=r(962);class i{getMeter(e,t,r){return s.NOOP_METER}}t.NoopMeterProvider=i,t.NOOP_METER_PROVIDER=new i},966:function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(652),t)},385:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._globalThis=void 0,t._globalThis="object"==typeof globalThis?globalThis:r.g},652:function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(385),t)},251:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.propagation=void 0;let s=r(930);t.propagation=s.PropagationAPI.getInstance()},600:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTextMapPropagator=void 0,t.NoopTextMapPropagator=class{inject(e,t){}extract(e,t){return e}fields(){return[]}}},625:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTextMapSetter=t.defaultTextMapGetter=void 0,t.defaultTextMapGetter={get(e,t){if(null!=e)return e[t]},keys:e=>null==e?[]:Object.keys(e)},t.defaultTextMapSetter={set(e,t,r){null!=e&&(e[t]=r)}}},978:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trace=void 0;let s=r(967);t.trace=s.TraceAPI.getInstance()},76:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonRecordingSpan=void 0;let s=r(304);t.NonRecordingSpan=class{constructor(e=s.INVALID_SPAN_CONTEXT){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}recordException(e,t){}}},527:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracer=void 0;let s=r(339),i=r(542),n=r(76),a=r(994),o=s.ContextAPI.getInstance();t.NoopTracer=class{startSpan(e,t,r=o.active()){let s=!!(null==t?void 0:t.root);if(s)return new n.NonRecordingSpan;let l=r&&(0,i.getSpanContext)(r);return"object"==typeof l&&"string"==typeof l.spanId&&"string"==typeof l.traceId&&"number"==typeof l.traceFlags&&(0,a.isSpanContextValid)(l)?new n.NonRecordingSpan(l):new n.NonRecordingSpan}startActiveSpan(e,t,r,s){let n,a,l;if(arguments.length<2)return;2==arguments.length?l=t:3==arguments.length?(n=t,l=r):(n=t,a=r,l=s);let h=null!=a?a:o.active(),c=this.startSpan(e,n,h),u=(0,i.setSpan)(h,c);return o.with(u,l,void 0,c)}}},228:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracerProvider=void 0;let s=r(527);t.NoopTracerProvider=class{getTracer(e,t,r){return new s.NoopTracer}}},387:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracer=void 0;let s=r(527),i=new s.NoopTracer;t.ProxyTracer=class{constructor(e,t,r,s){this._provider=e,this.name=t,this.version=r,this.options=s}startSpan(e,t,r){return this._getTracer().startSpan(e,t,r)}startActiveSpan(e,t,r,s){let i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)}_getTracer(){if(this._delegate)return this._delegate;let e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):i}}},414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracerProvider=void 0;let s=r(387),i=r(228),n=new i.NoopTracerProvider;t.ProxyTracerProvider=class{getTracer(e,t,r){var i;return null!==(i=this.getDelegateTracer(e,t,r))&&void 0!==i?i:new s.ProxyTracer(this,e,t,r)}getDelegate(){var e;return null!==(e=this._delegate)&&void 0!==e?e:n}setDelegate(e){this._delegate=e}getDelegateTracer(e,t,r){var s;return null===(s=this._delegate)||void 0===s?void 0:s.getTracer(e,t,r)}}},505:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(t.SamplingDecision||(t.SamplingDecision={}))},542:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpanContext=t.setSpanContext=t.deleteSpan=t.setSpan=t.getActiveSpan=t.getSpan=void 0;let s=r(421),i=r(76),n=r(339),a=(0,s.createContextKey)("OpenTelemetry Context Key SPAN");function o(e){return e.getValue(a)||void 0}function l(e,t){return e.setValue(a,t)}t.getSpan=o,t.getActiveSpan=function(){return o(n.ContextAPI.getInstance().active())},t.setSpan=l,t.deleteSpan=function(e){return e.deleteValue(a)},t.setSpanContext=function(e,t){return l(e,new i.NonRecordingSpan(t))},t.getSpanContext=function(e){var t;return null===(t=o(e))||void 0===t?void 0:t.spanContext()}},430:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceStateImpl=void 0;let s=r(450);class i{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){let r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r}unset(e){let t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,t)=>(e.push(t+"="+this.get(t)),e),[]).join(",")}_parse(e){!(e.length>512)&&(this._internalState=e.split(",").reverse().reduce((e,t)=>{let r=t.trim(),i=r.indexOf("=");if(-1!==i){let n=r.slice(0,i),a=r.slice(i+1,t.length);(0,s.validateKey)(n)&&(0,s.validateValue)(a)&&e.set(n,a)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new i;return e._internalState=new Map(this._internalState),e}}t.TraceStateImpl=i},450:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateValue=t.validateKey=void 0;let r="[_0-9a-z-*/]",s=`[a-z]${r}{0,255}`,i=`[a-z0-9]${r}{0,240}@[a-z]${r}{0,13}`,n=RegExp(`^(?:${s}|${i})$`),a=/^[ -~]{0,255}[!-~]$/,o=/,|=/;t.validateKey=function(e){return n.test(e)},t.validateValue=function(e){return a.test(e)&&!o.test(e)}},757:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTraceState=void 0;let s=r(430);t.createTraceState=function(e){return new s.TraceStateImpl(e)}},304:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;let s=r(762);t.INVALID_SPANID="0000000000000000",t.INVALID_TRACEID="00000000000000000000000000000000",t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:s.TraceFlags.NONE}},902:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(t.SpanKind||(t.SpanKind={}))},994:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapSpanContext=t.isSpanContextValid=t.isValidSpanId=t.isValidTraceId=void 0;let s=r(304),i=r(76),n=/^([0-9a-f]{32})$/i,a=/^[0-9a-f]{16}$/i;function o(e){return n.test(e)&&e!==s.INVALID_TRACEID}function l(e){return a.test(e)&&e!==s.INVALID_SPANID}t.isValidTraceId=o,t.isValidSpanId=l,t.isSpanContextValid=function(e){return o(e.traceId)&&l(e.spanId)},t.wrapSpanContext=function(e){return new i.NonRecordingSpan(e)}},832:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanStatusCode=void 0,function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(t.SpanStatusCode||(t.SpanStatusCode={}))},762:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(t.TraceFlags||(t.TraceFlags={}))},520:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="1.4.1"}},s={};function i(e){var r=s[e];if(void 0!==r)return r.exports;var n=s[e]={exports:{}},a=!0;try{t[e].call(n.exports,n,n.exports,i),a=!1}finally{a&&delete s[e]}return n.exports}i.ab="//";var n={};(()=>{Object.defineProperty(n,"__esModule",{value:!0}),n.trace=n.propagation=n.metrics=n.diag=n.context=n.INVALID_SPAN_CONTEXT=n.INVALID_TRACEID=n.INVALID_SPANID=n.isValidSpanId=n.isValidTraceId=n.isSpanContextValid=n.createTraceState=n.TraceFlags=n.SpanStatusCode=n.SpanKind=n.SamplingDecision=n.ProxyTracerProvider=n.ProxyTracer=n.defaultTextMapSetter=n.defaultTextMapGetter=n.ValueType=n.createNoopMeter=n.DiagLogLevel=n.DiagConsoleLogger=n.ROOT_CONTEXT=n.createContextKey=n.baggageEntryMetadataFromString=void 0;var e=i(701);Object.defineProperty(n,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return e.baggageEntryMetadataFromString}});var t=i(421);Object.defineProperty(n,"createContextKey",{enumerable:!0,get:function(){return t.createContextKey}}),Object.defineProperty(n,"ROOT_CONTEXT",{enumerable:!0,get:function(){return t.ROOT_CONTEXT}});var r=i(689);Object.defineProperty(n,"DiagConsoleLogger",{enumerable:!0,get:function(){return r.DiagConsoleLogger}});var s=i(133);Object.defineProperty(n,"DiagLogLevel",{enumerable:!0,get:function(){return s.DiagLogLevel}});var a=i(962);Object.defineProperty(n,"createNoopMeter",{enumerable:!0,get:function(){return a.createNoopMeter}});var o=i(28);Object.defineProperty(n,"ValueType",{enumerable:!0,get:function(){return o.ValueType}});var l=i(625);Object.defineProperty(n,"defaultTextMapGetter",{enumerable:!0,get:function(){return l.defaultTextMapGetter}}),Object.defineProperty(n,"defaultTextMapSetter",{enumerable:!0,get:function(){return l.defaultTextMapSetter}});var h=i(387);Object.defineProperty(n,"ProxyTracer",{enumerable:!0,get:function(){return h.ProxyTracer}});var c=i(414);Object.defineProperty(n,"ProxyTracerProvider",{enumerable:!0,get:function(){return c.ProxyTracerProvider}});var u=i(505);Object.defineProperty(n,"SamplingDecision",{enumerable:!0,get:function(){return u.SamplingDecision}});var d=i(902);Object.defineProperty(n,"SpanKind",{enumerable:!0,get:function(){return d.SpanKind}});var f=i(832);Object.defineProperty(n,"SpanStatusCode",{enumerable:!0,get:function(){return f.SpanStatusCode}});var p=i(762);Object.defineProperty(n,"TraceFlags",{enumerable:!0,get:function(){return p.TraceFlags}});var g=i(757);Object.defineProperty(n,"createTraceState",{enumerable:!0,get:function(){return g.createTraceState}});var v=i(994);Object.defineProperty(n,"isSpanContextValid",{enumerable:!0,get:function(){return v.isSpanContextValid}}),Object.defineProperty(n,"isValidTraceId",{enumerable:!0,get:function(){return v.isValidTraceId}}),Object.defineProperty(n,"isValidSpanId",{enumerable:!0,get:function(){return v.isValidSpanId}});var m=i(304);Object.defineProperty(n,"INVALID_SPANID",{enumerable:!0,get:function(){return m.INVALID_SPANID}}),Object.defineProperty(n,"INVALID_TRACEID",{enumerable:!0,get:function(){return m.INVALID_TRACEID}}),Object.defineProperty(n,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return m.INVALID_SPAN_CONTEXT}});let y=i(388);Object.defineProperty(n,"context",{enumerable:!0,get:function(){return y.context}});let b=i(920);Object.defineProperty(n,"diag",{enumerable:!0,get:function(){return b.diag}});let _=i(934);Object.defineProperty(n,"metrics",{enumerable:!0,get:function(){return _.metrics}});let w=i(251);Object.defineProperty(n,"propagation",{enumerable:!0,get:function(){return w.propagation}});let S=i(978);Object.defineProperty(n,"trace",{enumerable:!0,get:function(){return S.trace}}),n.default={context:y.context,diag:b.diag,metrics:_.metrics,propagation:w.propagation,trace:S.trace}})(),e.exports=n})()},9063:e=>{"use strict";(()=>{"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab="//");var t={};(()=>{/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */t.parse=function(t,r){if("string"!=typeof t)throw TypeError("argument str must be a string");for(var i={},n=t.split(s),a=(r||{}).decode||e,o=0;o<n.length;o++){var l=n[o],h=l.indexOf("=");if(!(h<0)){var c=l.substr(0,h).trim(),u=l.substr(++h,l.length).trim();'"'==u[0]&&(u=u.slice(1,-1)),void 0==i[c]&&(i[c]=function(e,t){try{return t(e)}catch(t){return e}}(u,a))}}return i},t.serialize=function(e,t,s){var n=s||{},a=n.encode||r;if("function"!=typeof a)throw TypeError("option encode is invalid");if(!i.test(e))throw TypeError("argument name is invalid");var o=a(t);if(o&&!i.test(o))throw TypeError("argument val is invalid");var l=e+"="+o;if(null!=n.maxAge){var h=n.maxAge-0;if(isNaN(h)||!isFinite(h))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(h)}if(n.domain){if(!i.test(n.domain))throw TypeError("option domain is invalid");l+="; Domain="+n.domain}if(n.path){if(!i.test(n.path))throw TypeError("option path is invalid");l+="; Path="+n.path}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(l+="; HttpOnly"),n.secure&&(l+="; Secure"),n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l};var e=decodeURIComponent,r=encodeURIComponent,s=/; */,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),e.exports=t})()},937:e=>{"use strict";(()=>{var t={806:(e,t,r)=>{let s=r(190),i=Symbol("max"),n=Symbol("length"),a=Symbol("lengthCalculator"),o=Symbol("allowStale"),l=Symbol("maxAge"),h=Symbol("dispose"),c=Symbol("noDisposeOnSet"),u=Symbol("lruList"),d=Symbol("cache"),f=Symbol("updateAgeOnGet"),p=()=>1,g=(e,t,r)=>{let s=e[d].get(t);if(s){let t=s.value;if(v(e,t)){if(y(e,s),!e[o])return}else r&&(e[f]&&(s.value.now=Date.now()),e[u].unshiftNode(s));return t.value}},v=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;let r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[l]&&r>e[l]},m=e=>{if(e[n]>e[i])for(let t=e[u].tail;e[n]>e[i]&&null!==t;){let r=t.prev;y(e,t),t=r}},y=(e,t)=>{if(t){let r=t.value;e[h]&&e[h](r.key,r.value),e[n]-=r.length,e[d].delete(r.key),e[u].removeNode(t)}};class b{constructor(e,t,r,s,i){this.key=e,this.value=t,this.length=r,this.now=s,this.maxAge=i||0}}let _=(e,t,r,s)=>{let i=r.value;v(e,i)&&(y(e,r),e[o]||(i=void 0)),i&&t.call(s,i.value,i.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw TypeError("max must be a non-negative number");this[i]=e.max||1/0;let t=e.length||p;if(this[a]="function"!=typeof t?p:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[h]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[f]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw TypeError("max must be a non-negative number");this[i]=e||1/0,m(this)}get max(){return this[i]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw TypeError("maxAge must be a non-negative number");this[l]=e,m(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=p),e!==this[a]&&(this[a]=e,this[n]=0,this[u].forEach(e=>{e.length=this[a](e.value,e.key),this[n]+=e.length})),m(this)}get lengthCalculator(){return this[a]}get length(){return this[n]}get itemCount(){return this[u].length}rforEach(e,t){t=t||this;for(let r=this[u].tail;null!==r;){let s=r.prev;_(this,e,r,t),r=s}}forEach(e,t){t=t||this;for(let r=this[u].head;null!==r;){let s=r.next;_(this,e,r,t),r=s}}keys(){return this[u].toArray().map(e=>e.key)}values(){return this[u].toArray().map(e=>e.value)}reset(){this[h]&&this[u]&&this[u].length&&this[u].forEach(e=>this[h](e.key,e.value)),this[d]=new Map,this[u]=new s,this[n]=0}dump(){return this[u].map(e=>!v(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[u]}set(e,t,r){if((r=r||this[l])&&"number"!=typeof r)throw TypeError("maxAge must be a number");let s=r?Date.now():0,o=this[a](t,e);if(this[d].has(e)){if(o>this[i])return y(this,this[d].get(e)),!1;let a=this[d].get(e),l=a.value;return this[h]&&!this[c]&&this[h](e,l.value),l.now=s,l.maxAge=r,l.value=t,this[n]+=o-l.length,l.length=o,this.get(e),m(this),!0}let f=new b(e,t,o,s,r);return f.length>this[i]?(this[h]&&this[h](e,t),!1):(this[n]+=f.length,this[u].unshift(f),this[d].set(e,this[u].head),m(this),!0)}has(e){if(!this[d].has(e))return!1;let t=this[d].get(e).value;return!v(this,t)}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){let e=this[u].tail;return e?(y(this,e),e.value):null}del(e){y(this,this[d].get(e))}load(e){this.reset();let t=Date.now();for(let r=e.length-1;r>=0;r--){let s=e[r],i=s.e||0;if(0===i)this.set(s.k,s.v);else{let e=i-t;e>0&&this.set(s.k,s.v,e)}}}prune(){this[d].forEach((e,t)=>g(this,t,!1))}}},76:e=>{e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},190:(e,t,r)=>{function s(e){var t=this;if(t instanceof s||(t=new s),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)t.push(arguments[r]);return t}function i(e,t,r,s){if(!(this instanceof i))return new i(e,t,r,s);this.list=s,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=s,s.Node=i,s.create=s,s.prototype.removeNode=function(e){if(e.list!==this)throw Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},s.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},s.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},s.prototype.push=function(){for(var e,t=0,r=arguments.length;t<r;t++)e=arguments[t],this.tail=new i(e,this.tail,null,this),this.head||(this.head=this.tail),this.length++;return this.length},s.prototype.unshift=function(){for(var e,t=0,r=arguments.length;t<r;t++)e=arguments[t],this.head=new i(e,null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length},s.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},s.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},s.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,s=0;null!==r;s++)e.call(t,r.value,s,this),r=r.next},s.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,s=this.length-1;null!==r;s--)e.call(t,r.value,s,this),r=r.prev},s.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},s.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},s.prototype.map=function(e,t){t=t||this;for(var r=new s,i=this.head;null!==i;)r.push(e.call(t,i.value,this)),i=i.next;return r},s.prototype.mapReverse=function(e,t){t=t||this;for(var r=new s,i=this.tail;null!==i;)r.push(e.call(t,i.value,this)),i=i.prev;return r},s.prototype.reduce=function(e,t){var r,s=this.head;if(arguments.length>1)r=t;else if(this.head)s=this.head.next,r=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var i=0;null!==s;i++)r=e(r,s.value,i),s=s.next;return r},s.prototype.reduceReverse=function(e,t){var r,s=this.tail;if(arguments.length>1)r=t;else if(this.tail)s=this.tail.prev,r=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;null!==s;i--)r=e(r,s.value,i),s=s.prev;return r},s.prototype.toArray=function(){for(var e=Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},s.prototype.toArrayReverse=function(){for(var e=Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},s.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new s;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,n=this.head;null!==n&&i<e;i++)n=n.next;for(;null!==n&&i<t;i++,n=n.next)r.push(n.value);return r},s.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new s;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,n=this.tail;null!==n&&i>t;i--)n=n.prev;for(;null!==n&&i>e;i--,n=n.prev)r.push(n.value);return r},s.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,s=this.head;null!==s&&r<e;r++)s=s.next;for(var n=[],r=0;s&&r<t;r++)n.push(s.value),s=this.removeNode(s);null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var r=2;r<arguments.length;r++)s=function(e,t,r){var s=t===e.head?new i(r,null,t,e):new i(r,t,t.next,e);return null===s.next&&(e.tail=s),null===s.prev&&(e.head=s),e.length++,s}(this,s,arguments[r]);return n},s.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var s=r.prev;r.prev=r.next,r.next=s}return this.head=t,this.tail=e,this};try{r(76)(s)}catch(e){}}},r={};function s(e){var i=r[e];if(void 0!==i)return i.exports;var n=r[e]={exports:{}},a=!0;try{t[e](n,n.exports,s),a=!1}finally{a&&delete r[e]}return n.exports}s.ab="//";var i=s(806);e.exports=i})()},9368:e=>{"use strict";!function(){var t={114:function(e){function t(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function r(e,t){for(var r,s="",i=0,n=-1,a=0,o=0;o<=e.length;++o){if(o<e.length)r=e.charCodeAt(o);else if(47===r)break;else r=47;if(47===r){if(n===o-1||1===a);else if(n!==o-1&&2===a){if(s.length<2||2!==i||46!==s.charCodeAt(s.length-1)||46!==s.charCodeAt(s.length-2)){if(s.length>2){var l=s.lastIndexOf("/");if(l!==s.length-1){-1===l?(s="",i=0):i=(s=s.slice(0,l)).length-1-s.lastIndexOf("/"),n=o,a=0;continue}}else if(2===s.length||1===s.length){s="",i=0,n=o,a=0;continue}}t&&(s.length>0?s+="/..":s="..",i=2)}else s.length>0?s+="/"+e.slice(n+1,o):s=e.slice(n+1,o),i=o-n-1;n=o,a=0}else 46===r&&-1!==a?++a:a=-1}return s}var s={resolve:function(){for(var e,s,i="",n=!1,a=arguments.length-1;a>=-1&&!n;a--)a>=0?s=arguments[a]:(void 0===e&&(e=""),s=e),t(s),0!==s.length&&(i=s+"/"+i,n=47===s.charCodeAt(0));return(i=r(i,!n),n)?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var s=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return(0!==(e=r(e,!s)).length||s||(e="."),e.length>0&&i&&(e+="/"),s)?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0==arguments.length)return".";for(var e,r=0;r<arguments.length;++r){var i=arguments[r];t(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":s.normalize(e)},relative:function(e,r){if(t(e),t(r),e===r||(e=s.resolve(e))===(r=s.resolve(r)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var n=e.length,a=n-i,o=1;o<r.length&&47===r.charCodeAt(o);++o);for(var l=r.length-o,h=a<l?a:l,c=-1,u=0;u<=h;++u){if(u===h){if(l>h){if(47===r.charCodeAt(o+u))return r.slice(o+u+1);if(0===u)return r.slice(o+u)}else a>h&&(47===e.charCodeAt(i+u)?c=u:0===u&&(c=0));break}var d=e.charCodeAt(i+u);if(d!==r.charCodeAt(o+u))break;47===d&&(c=u)}var f="";for(u=i+c+1;u<=n;++u)(u===n||47===e.charCodeAt(u))&&(0===f.length?f+="..":f+="/..");return f.length>0?f+r.slice(o+c):(o+=c,47===r.charCodeAt(o)&&++o,r.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var r=e.charCodeAt(0),s=47===r,i=-1,n=!0,a=e.length-1;a>=1;--a)if(47===(r=e.charCodeAt(a))){if(!n){i=a;break}}else n=!1;return -1===i?s?"/":".":s&&1===i?"//":e.slice(0,i)},basename:function(e,r){if(void 0!==r&&"string"!=typeof r)throw TypeError('"ext" argument must be a string');t(e);var s,i=0,n=-1,a=!0;if(void 0!==r&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var o=r.length-1,l=-1;for(s=e.length-1;s>=0;--s){var h=e.charCodeAt(s);if(47===h){if(!a){i=s+1;break}}else -1===l&&(a=!1,l=s+1),o>=0&&(h===r.charCodeAt(o)?-1==--o&&(n=s):(o=-1,n=l))}return i===n?n=l:-1===n&&(n=e.length),e.slice(i,n)}for(s=e.length-1;s>=0;--s)if(47===e.charCodeAt(s)){if(!a){i=s+1;break}}else -1===n&&(a=!1,n=s+1);return -1===n?"":e.slice(i,n)},extname:function(e){t(e);for(var r=-1,s=0,i=-1,n=!0,a=0,o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(47===l){if(!n){s=o+1;break}continue}-1===i&&(n=!1,i=o+1),46===l?-1===r?r=o:1!==a&&(a=1):-1!==r&&(a=-1)}return -1===r||-1===i||0===a||1===a&&r===i-1&&r===s+1?"":e.slice(r,i)},format:function(e){var t,r;if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||""),t?t===e.root?t+r:t+"/"+r:r},parse:function(e){t(e);var r,s={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return s;var i=e.charCodeAt(0),n=47===i;n?(s.root="/",r=1):r=0;for(var a=-1,o=0,l=-1,h=!0,c=e.length-1,u=0;c>=r;--c){if(47===(i=e.charCodeAt(c))){if(!h){o=c+1;break}continue}-1===l&&(h=!1,l=c+1),46===i?-1===a?a=c:1!==u&&(u=1):-1!==a&&(u=-1)}return -1===a||-1===l||0===u||1===u&&a===l-1&&a===o+1?-1!==l&&(0===o&&n?s.base=s.name=e.slice(1,l):s.base=s.name=e.slice(o,l)):(0===o&&n?(s.name=e.slice(1,a),s.base=e.slice(1,l)):(s.name=e.slice(o,a),s.base=e.slice(o,l)),s.ext=e.slice(a,l)),o>0?s.dir=e.slice(0,o-1):n&&(s.dir="/"),s},sep:"/",delimiter:":",win32:null,posix:null};s.posix=s,e.exports=s}},r={};function s(e){var i=r[e];if(void 0!==i)return i.exports;var n=r[e]={exports:{}},a=!0;try{t[e](n,n.exports,s),a=!1}finally{a&&delete r[e]}return n.exports}s.ab="//";var i=s(114);e.exports=i}()},1691:(e,t,r)=>{"use strict";r.d(t,{H4:()=>l,i4:()=>s,ph:()=>i,pz:()=>n,vu:()=>o,yR:()=>a});let s="RSC",i="Next-Router-State-Tree",n="Next-Router-Prefetch",a="x-vercel-sc-headers",o=[[s],[i],[n]],l="_rsc"},4926:(e,t,r)=>{"use strict";r.r(t),r.d(t,{cookies:()=>u,draftMode:()=>d,headers:()=>c});var s=r(9375),i=r(9183),n=r(3627),a=r(533),o=r(5430),l=r(3766);class h{get isEnabled(){return this._provider.isEnabled}enable(){if(!(0,l.staticGenerationBailout)("draftMode().enable()"))return this._provider.enable()}disable(){if(!(0,l.staticGenerationBailout)("draftMode().disable()"))return this._provider.disable()}constructor(e){this._provider=e}}function c(){if((0,l.staticGenerationBailout)("headers"))return i.h.seal(new Headers({}));let e=a.requestAsyncStorage.getStore();if(!e)throw Error("Invariant: Method expects to have requestAsyncStorage, none available");return e.headers}function u(){if((0,l.staticGenerationBailout)("cookies"))return s.Qb.seal(new n.q(new Headers({})));let e=a.requestAsyncStorage.getStore();if(!e)throw Error("Invariant: Method expects to have requestAsyncStorage, none available");let t=o.actionAsyncStorage.getStore();return t&&(t.isAction||t.isAppRoute)?e.mutableCookies:e.cookies}function d(){let e=a.requestAsyncStorage.getStore();if(!e)throw Error("Invariant: Method expects to have requestAsyncStorage, none available");return new h(e.draftMode)}},4721:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DYNAMIC_ERROR_CODE:()=>s,DynamicServerError:()=>i});let s="DYNAMIC_SERVER_USAGE";class i extends Error{constructor(e){super("Dynamic server usage: "+e),this.digest=s}}},3766:(e,t,r)=>{"use strict";r.r(t),r.d(t,{staticGenerationBailout:()=>a});var s=r(4721),i=r(5948);class n extends Error{constructor(...e){super(...e),this.code="NEXT_STATIC_GEN_BAILOUT"}}let a=(e,t)=>{let r=i.staticGenerationAsyncStorage.getStore();if(null==r?void 0:r.forceStatic)return!0;if(null==r?void 0:r.dynamicShouldError){let{dynamic:r="error",link:s}=t||{};throw new n('Page with `dynamic = "'+r+"\"` couldn't be rendered statically because it used `"+e+"`."+(s?" See more info here: "+s:""))}if(r&&(r.revalidate=0),null==r?void 0:r.isStaticGeneration){let t=new s.DynamicServerError(e);throw r.dynamicUsageDescription=e,r.dynamicUsageStack=t.stack,t}return!1}},821:(e,t,r)=>{"use strict";r.d(t,{BR:()=>a,Qq:()=>n,dN:()=>s,y3:()=>i});let s="nxtP",i="x-prerender-revalidate",n="x-prerender-revalidate-if-generated",a=31536e3,o={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"actionBrowser",api:"api",middleware:"middleware",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",appMetadataRoute:"app-metadata-route"};({...o,GROUP:{server:[o.reactServerComponents,o.actionBrowser,o.appMetadataRoute]}})},5803:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});let s=new Proxy(e=>e,{get:(e,t)=>["hex","rgb","ansi256","bgHex","bgRgb","bgAnsi256"].includes(t)?()=>s:s}),i=s},4487:(e,t,r)=>{"use strict";let s,i;r.d(t,{Z:()=>en});class n{constructor({userland:e,definition:t}){this.userland=e,this.definition=t}}var a,o,l,h,c,u,d,f,p,g,v,m,y,b=r(1691),_=r(9183),w=r(9375),S=r(3627),T=r(821);let x="__prerender_bypass";Symbol("__next_preview_data"),Symbol(x);class E{constructor(e,t,r,s){var i;let n=e&&function(e,t){let r=_.h.from(e.headers),s=r.get(T.y3),i=s===t.previewModeId,n=r.has(T.Qq);return{isOnDemandRevalidate:i,revalidateOnlyGenerated:n}}(t,e).isOnDemandRevalidate,a=null==(i=r.get(x))?void 0:i.value;this.isEnabled=!!(!n&&a&&e&&a===e.previewModeId),this._previewModeId=null==e?void 0:e.previewModeId,this._mutableCookies=s}enable(){if(!this._previewModeId)throw Error("Invariant: previewProps missing previewModeId this should never happen");this._mutableCookies.set({name:x,value:this._previewModeId,httpOnly:!0,sameSite:"none",secure:!0,path:"/"})}disable(){this._mutableCookies.set({name:x,value:"",httpOnly:!0,sameSite:"none",secure:!0,path:"/",expires:new Date(0)})}}let P={wrap(e,{req:t,res:r,renderOpts:s},i){let n;s&&"previewProps"in s&&(n=s.previewProps);let a={},o={get headers(){return a.headers||(a.headers=function(e){let t=_.h.from(e);for(let e of b.vu)t.delete(e.toString().toLowerCase());return _.h.seal(t)}(t.headers)),a.headers},get cookies(){return a.cookies||(a.cookies=function(e){let t=new S.q(_.h.from(e));return w.Qb.seal(t)}(t.headers)),a.cookies},get mutableCookies(){return a.mutableCookies||(a.mutableCookies=function(e,t){let r=new S.q(_.h.from(e));return w.vr.wrap(r,t)}(t.headers,r)),a.mutableCookies},get draftMode(){return a.draftMode||(a.draftMode=new E(n,t,this.cookies,this.mutableCookies)),a.draftMode}};return e.run(o,i,o)}},O={wrap(e,{pathname:t,renderOpts:r},s){let i=!r.supportsDynamicHTML&&!r.isDraftMode,n={isStaticGeneration:i,pathname:t,originalPathname:r.originalPathname,incrementalCache:r.incrementalCache||globalThis.__incrementalCache,isRevalidate:r.isRevalidate,isPrerendering:r.nextExport,fetchCache:r.fetchCache,isOnDemandRevalidate:r.isOnDemandRevalidate,isDraftMode:r.isDraftMode};return r.store=n,e.run(n,s,n)}};function C(){return new Response(null,{status:400})}function R(){return new Response(null,{status:405})}let k=["GET","HEAD","OPTIONS","POST","PUT","DELETE","PATCH"];!function(e){e.handleRequest="BaseServer.handleRequest",e.run="BaseServer.run",e.pipe="BaseServer.pipe",e.getStaticHTML="BaseServer.getStaticHTML",e.render="BaseServer.render",e.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",e.renderToResponse="BaseServer.renderToResponse",e.renderToHTML="BaseServer.renderToHTML",e.renderError="BaseServer.renderError",e.renderErrorToResponse="BaseServer.renderErrorToResponse",e.renderErrorToHTML="BaseServer.renderErrorToHTML",e.render404="BaseServer.render404"}(a||(a={})),function(e){e.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",e.loadComponents="LoadComponents.loadComponents"}(o||(o={})),function(e){e.getRequestHandler="NextServer.getRequestHandler",e.getServer="NextServer.getServer",e.getServerRequestHandler="NextServer.getServerRequestHandler",e.createServer="createServer.createServer"}(l||(l={})),function(e){e.compression="NextNodeServer.compression",e.getBuildId="NextNodeServer.getBuildId",e.generateStaticRoutes="NextNodeServer.generateStaticRoutes",e.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",e.generatePublicRoutes="NextNodeServer.generatePublicRoutes",e.generateImageRoutes="NextNodeServer.generateImageRoutes.route",e.sendRenderResult="NextNodeServer.sendRenderResult",e.sendStatic="NextNodeServer.sendStatic",e.proxyRequest="NextNodeServer.proxyRequest",e.runApi="NextNodeServer.runApi",e.render="NextNodeServer.render",e.renderHTML="NextNodeServer.renderHTML",e.imageOptimizer="NextNodeServer.imageOptimizer",e.getPagePath="NextNodeServer.getPagePath",e.getRoutesManifest="NextNodeServer.getRoutesManifest",e.findPageComponents="NextNodeServer.findPageComponents",e.getFontManifest="NextNodeServer.getFontManifest",e.getServerComponentManifest="NextNodeServer.getServerComponentManifest",e.getRequestHandler="NextNodeServer.getRequestHandler",e.renderToHTML="NextNodeServer.renderToHTML",e.renderError="NextNodeServer.renderError",e.renderErrorToHTML="NextNodeServer.renderErrorToHTML",e.render404="NextNodeServer.render404",e.route="route",e.onProxyReq="onProxyReq",e.apiResolver="apiResolver"}(h||(h={})),(c||(c={})).startServer="startServer.startServer",function(e){e.getServerSideProps="Render.getServerSideProps",e.getStaticProps="Render.getStaticProps",e.renderToString="Render.renderToString",e.renderDocument="Render.renderDocument",e.createBodyResult="Render.createBodyResult"}(u||(u={})),function(e){e.renderToString="AppRender.renderToString",e.renderToReadableStream="AppRender.renderToReadableStream",e.getBodyResult="AppRender.getBodyResult",e.fetch="AppRender.fetch"}(d||(d={})),(f||(f={})).executeRoute="Router.executeRoute",(p||(p={})).runHandler="Node.runHandler",(g||(g={})).runHandler="AppRouteRouteHandlers.runHandler",(v||(v={})).generateMetadata="ResolveMetadata.generateMetadata";let A=["BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata"];s=r(5049);let{context:j,trace:I,SpanStatusCode:N,SpanKind:$}=s,D=e=>null!==e&&"object"==typeof e&&"function"==typeof e.then,L=(e,t)=>{t&&e.recordException(t),e.setStatus({code:N.ERROR,message:null==t?void 0:t.message}),e.end()},M=new Map,U=s.createContextKey("next.rootSpanId"),B=0,H=()=>B++;class q{getTracerInstance(){return I.getTracer("next.js","0.0.1")}getContext(){return j}getActiveScopeSpan(){return I.getSpan(null==j?void 0:j.active())}trace(...e){let[t,r,i]=e,{fn:n,options:a}="function"==typeof r?{fn:r,options:{}}:{fn:i,options:{...r}};if(!A.includes(t)&&"1"!==process.env.NEXT_OTEL_VERBOSE||a.hideSpan)return n();let o=a.spanName??t,l=this.getSpanContext((null==a?void 0:a.parentSpan)??this.getActiveScopeSpan()),h=!1;l||(l=s.ROOT_CONTEXT,h=!0);let c=H();return a.attributes={"next.span_name":o,"next.span_type":t,...a.attributes},s.context.with(l.setValue(U,c),()=>this.getTracerInstance().startActiveSpan(o,a,e=>{let t=()=>{M.delete(c)};h&&M.set(c,new Map(Object.entries(a.attributes??{})));try{if(n.length>1)return n(e,t=>L(e,t));let r=n(e);return D(r)?r.then(()=>e.end(),t=>L(e,t)).finally(t):(e.end(),t()),r}catch(r){throw L(e,r),t(),r}}))}wrap(...e){let t=this,[r,s,i]=3===e.length?e:[e[0],{},e[1]];return A.includes(r)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let e=s;"function"==typeof e&&"function"==typeof i&&(e=e.apply(this,arguments));let n=arguments.length-1,a=arguments[n];if("function"!=typeof a)return t.trace(r,e,()=>i.apply(this,arguments));{let s=t.getContext().bind(j.active(),a);return t.trace(r,e,(e,t)=>(arguments[n]=function(e){return null==t||t(e),s.apply(this,arguments)},i.apply(this,arguments)))}}:i}startSpan(...e){let[t,r]=e,s=this.getSpanContext((null==r?void 0:r.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(t,r,s)}getSpanContext(e){let t=e?I.setSpan(j.active(),e):void 0;return t}getRootSpanAttributes(){let e=j.active().getValue(U);return M.get(e)}}let G=(()=>{let e=new q;return()=>e})();var F=r(6195).Buffer;function V(e){let t=[],r=null==e?void 0:e.originalPathname;return r&&(Array.isArray(e.tags)||(e.tags=[]),e.tags.includes(r)||e.tags.push(r),t.push(r)),t}function z(e,t){if(!e)return;e.fetchMetrics||(e.fetchMetrics=[]);let r=["url","status","method"];e.fetchMetrics.some(e=>r.every(r=>e[r]===t[r]))||e.fetchMetrics.push({url:t.url,cacheStatus:t.cacheStatus,status:t.status,method:t.method,start:t.start,end:Date.now(),idx:e.nextFetchId||0})}var K=r(3928),J=r(580);function W(e){let t=new URL(e);return t.host="localhost:3000",t.search="",t.protocol="http",t.toString()}function X(e){if("string"!=typeof(null==e?void 0:e.digest))return!1;let[t,r,s]=e.digest.split(";",3);return"NEXT_REDIRECT"===t&&("replace"===r||"push"===r)&&"string"==typeof s}r(533),!function(e){e.push="push",e.replace="replace"}(m||(m={})),(i=r(5803).Z).cyan("wait"),i.red("error"),i.yellow("warn"),i.green("ready"),i.cyan("info"),i.magenta("event"),i.magenta("trace");let Y=["HEAD","OPTIONS"],Q=["OPTIONS","POST","PUT","DELETE","PATCH"];!function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(y||(y={}));let{requestAsyncStorage:Z}=r(533),{staticGenerationAsyncStorage:ee}=r(5948),et=r(4721),er=r(4926),{staticGenerationBailout:es}=r(3766),{actionAsyncStorage:ei}=r(5430),en=class extends n{static is(e){return e.definition.kind===y.APP_ROUTE}constructor({userland:e,definition:t,resolvedPagePath:r,nextConfigOutput:s}){if(super({userland:e,definition:t}),this.requestAsyncStorage=Z,this.staticGenerationAsyncStorage=ee,this.serverHooks=et,this.headerHooks=er,this.staticGenerationBailout=es,this.actionAsyncStorage=ei,this.resolvedPagePath=r,this.nextConfigOutput=s,this.methods=function(e){let t=k.reduce((t,r)=>({...t,[r]:e[r]??R}),{}),r=new Set(k.filter(t=>e[t])),s=Y.filter(e=>!r.has(e));for(let i of s){if("HEAD"===i){if(!e.GET)break;t.HEAD=e.GET,r.add("HEAD");continue}if("OPTIONS"===i){let e=["OPTIONS",...r];!r.has("HEAD")&&r.has("GET")&&e.push("HEAD");let s={Allow:e.sort().join(", ")};t.OPTIONS=()=>new Response(null,{status:204,headers:s}),r.add("OPTIONS");continue}throw Error(`Invariant: should handle all automatic implementable methods, got method: ${i}`)}return t}(e),this.nonStaticMethods=function(e){let t=Q.filter(t=>e[t]);return 0!==t.length&&t}(e),this.dynamic=this.userland.dynamic,"export"===this.nextConfigOutput){if(this.dynamic&&"auto"!==this.dynamic){if("force-dynamic"===this.dynamic)throw Error(`export const dynamic = "force-dynamic" on page "${t.pathname}" cannot be used with "output: export". See more info here: https://nextjs.org/docs/advanced-features/static-html-export`)}else this.dynamic="error"}}resolve(e){return k.includes(e)?this.methods[e]:C}async execute(e,t){let s=this.resolve(e.method),i={req:e};i.renderOpts={previewProps:t.prerenderManifest.preview};let n={pathname:this.definition.pathname,renderOpts:t.staticGenerationContext??{supportsDynamicHTML:!1}};n.renderOpts.fetchCache=this.userland.fetchCache;let a=await this.actionAsyncStorage.run({isAppRoute:!0},()=>P.wrap(this.requestAsyncStorage,i,()=>O.wrap(this.staticGenerationAsyncStorage,n,i=>{var n;switch(this.nonStaticMethods&&this.staticGenerationBailout(`non-static methods used ${this.nonStaticMethods.join(", ")}`),this.dynamic){case"force-dynamic":i.forceDynamic=!0,this.staticGenerationBailout("force-dynamic",{dynamic:this.dynamic});break;case"force-static":i.forceStatic=!0;break;case"error":i.dynamicShouldError=!0}i.revalidate??=this.userland.revalidate??!1;let a=function(e,{dynamic:t},r){function s(e){switch(e){case"search":case"searchParams":case"toString":case"href":case"origin":r.staticGenerationBailout(`nextUrl.${e}`);return;default:return}}let i={},n=(e,t)=>{switch(t){case"search":return"";case"searchParams":return i.searchParams||(i.searchParams=new URLSearchParams),i.searchParams;case"url":case"href":return i.url||(i.url=W(e)),i.url;case"toJSON":case"toString":return i.url||(i.url=W(e)),i.toString||(i.toString=()=>i.url),i.toString;case"headers":return i.headers||(i.headers=new Headers),i.headers;case"cookies":return i.headers||(i.headers=new Headers),i.cookies||(i.cookies=new K.RequestCookies(i.headers)),i.cookies;case"clone":return i.url||(i.url=W(e)),()=>new J.c(i.url)}},a=new Proxy(e.nextUrl,{get(e,r){if(s(r),"force-static"===t&&"string"==typeof r){let t=n(e.href,r);if(void 0!==t)return t}let i=e[r];return"function"==typeof i?i.bind(e):i},set:(e,t,r)=>(s(t),e[t]=r,!0)}),o=e=>{switch(e){case"headers":r.headerHooks.headers();return;case"url":case"body":case"blob":case"json":case"text":case"arrayBuffer":case"formData":r.staticGenerationBailout(`request.${e}`);return;default:return}};return new Proxy(e,{get(e,r){if(o(r),"nextUrl"===r)return a;if("force-static"===t&&"string"==typeof r){let t=n(e.url,r);if(void 0!==t)return t}let s=e[r];return"function"==typeof s?s.bind(e):s},set:(e,t,r)=>(o(t),e[t]=r,!0)})}(e,{dynamic:this.dynamic},{headerHooks:this.headerHooks,serverHooks:this.serverHooks,staticGenerationBailout:this.staticGenerationBailout}),o=function(e){let t="/app/";e.includes(t)||(t="\\app\\");let[,...r]=e.split(t),s=t[0]+r.join(t),i=s.split(".").slice(0,-1).join(".");return i}(this.resolvedPagePath);return null==(n=G().getRootSpanAttributes())||n.set("next.route",o),G().trace(g.runHandler,{spanName:`executing api route (app) ${o}`,attributes:{"next.route":o}},async()=>{var e;!function({serverHooks:e,staticGenerationAsyncStorage:t}){if(globalThis._nextOriginalFetch||(globalThis._nextOriginalFetch=globalThis.fetch),globalThis.fetch.__nextPatched)return;let{DynamicServerError:s}=e,i=globalThis._nextOriginalFetch;globalThis.fetch=async(e,n)=>{var a;let o;try{(o=new URL(e instanceof Request?e.url:e)).username="",o.password=""}catch{o=void 0}let l=(null==o?void 0:o.href)??"",h=Date.now(),c=(null==n?void 0:null==(a=n.method)?void 0:a.toUpperCase())||"GET";return await G().trace(d.fetch,{kind:$.CLIENT,spanName:["fetch",c,l].filter(Boolean).join(" "),attributes:{"http.url":l,"http.method":c,"net.peer.name":null==o?void 0:o.hostname,"net.peer.port":(null==o?void 0:o.port)||void 0}},async()=>{var a,o,c;let u,d;let f=t.getStore(),p=e&&"object"==typeof e&&"string"==typeof e.method,g=t=>(p?e[t]:null)||(null==n?void 0:n[t]);if(!f||(null==(a=null==n?void 0:n.next)?void 0:a.internal)||f.isDraftMode)return i(e,n);let v=t=>{var r,s,i;return void 0!==(null==n?void 0:null==(r=n.next)?void 0:r[t])?null==n?void 0:null==(s=n.next)?void 0:s[t]:p?null==(i=e.next)?void 0:i[t]:void 0},m=v("revalidate"),y=v("tags")||[];if(Array.isArray(y))for(let e of(f.tags||(f.tags=[]),y))f.tags.includes(e)||f.tags.push(e);let b=V(f);for(let e of b||[])y.includes(e)||y.push(e);let _="only-cache"===f.fetchCache,w="force-cache"===f.fetchCache,S="default-cache"===f.fetchCache,x="default-no-store"===f.fetchCache,E="only-no-store"===f.fetchCache,P="force-no-store"===f.fetchCache,O=g("cache");"string"==typeof O&&void 0!==m&&(console.warn(`Warning: fetch for ${l} on ${f.pathname} specified "cache: ${O}" and "revalidate: ${m}", only one should be specified.`),O=void 0),"force-cache"===O&&(m=!1),["no-cache","no-store"].includes(O||"")&&(m=0),("number"==typeof m||!1===m)&&(d=m);let C="",R=g("headers"),k="function"==typeof(null==R?void 0:R.get)?R:new Headers(R||{}),A=k.get("authorization")||k.get("cookie"),j=!["get","head"].includes((null==(o=g("method"))?void 0:o.toLowerCase())||"get"),I=(A||j)&&0===f.revalidate;if(P&&(d=0,C="fetchCache = force-no-store"),E){if("force-cache"===O||0===d)throw Error(`cache: 'force-cache' used on fetch for ${l} with 'export const fetchCache = 'only-no-store'`);d=0,C="fetchCache = only-no-store"}if(_&&"no-store"===O)throw Error(`cache: 'no-store' used on fetch for ${l} with 'export const fetchCache = 'only-cache'`);w&&(void 0===m||0===m)&&(C="fetchCache = force-cache",d=!1),void 0===d?S?(d=!1,C="fetchCache = default-cache"):I?(d=0,C="auto no cache"):x?(d=0,C="fetchCache = default-no-store"):(C="auto cache",d="boolean"!=typeof f.revalidate&&void 0!==f.revalidate&&f.revalidate):C||(C=`revalidate: ${d}`),!I&&(void 0===f.revalidate||"number"==typeof d&&(!1===f.revalidate||"number"==typeof f.revalidate&&d<f.revalidate))&&(f.revalidate=d);let N="number"==typeof d&&d>0||!1===d;if(f.incrementalCache&&N)try{u=await f.incrementalCache.fetchCacheKey(l,p?e:n)}catch(t){console.error("Failed to generate cache key for",e)}let $=["cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window","duplex"];if(p){let t=e,r={body:t._ogBody||t.body};for(let e of $)r[e]=t[e];e=new Request(t.url,r)}else if(n){let e=n;for(let t of(n={body:n._ogBody||n.body},$))n[t]=e[t]}let D=f.nextFetchId??1;f.nextFetchId=D+1;let L="number"!=typeof d?T.BR:d,M=async t=>{let r={...n,next:{...null==n?void 0:n.next,fetchType:"origin",fetchIdx:D}};return i(e,r).then(async s=>{if(t||z(f,{start:h,url:l,cacheReason:C,cacheStatus:"miss",status:s.status,method:r.method||"GET"}),200===s.status&&f.incrementalCache&&u&&N){let t=F.from(await s.arrayBuffer());try{await f.incrementalCache.set(u,{kind:"FETCH",data:{headers:Object.fromEntries(s.headers.entries()),body:t.toString("base64"),status:s.status,tags:y,url:s.url},revalidate:L},d,!0,l,D)}catch(t){console.warn("Failed to set fetch cache",e,t)}let r=new Response(t,{headers:new Headers(s.headers),status:s.status});return Object.defineProperty(r,"url",{value:s.url}),r}return s})};if(u&&(null==f?void 0:f.incrementalCache)){let e=f.isOnDemandRevalidate?null:await f.incrementalCache.get(u,!0,d,l,D);if((null==e?void 0:e.value)&&"FETCH"===e.value.kind){let t=e.value.data.tags;if(!(f.isRevalidate&&e.isStale)){let s;if(e.isStale)f.pendingRevalidates||(f.pendingRevalidates=[]),f.pendingRevalidates.push(M(!0).catch(console.error));else if(y&&!y.every(e=>null==t?void 0:t.includes(e))){for(let t of(e.value.data.tags||(e.value.data.tags=[]),y))e.value.data.tags.includes(t)||e.value.data.tags.push(t);null==(c=f.incrementalCache)||c.set(u,e.value,d,!0,l,D)}let i=e.value.data;{let{decode:e}=r(8135);s=e(i.body)}z(f,{start:h,url:l,cacheReason:C,cacheStatus:"hit",status:i.status||200,method:(null==n?void 0:n.method)||"GET"});let a=new Response(s,{headers:i.headers,status:i.status});return Object.defineProperty(a,"url",{value:e.value.data.url}),a}}}if(f.isStaticGeneration&&n&&"object"==typeof n){let t=n.cache;if(delete n.cache,"no-store"===t){f.revalidate=0;let t=`no-store fetch ${e}${f.pathname?` ${f.pathname}`:""}`,r=new s(t);f.dynamicUsageErr=r,f.dynamicUsageStack=r.stack,f.dynamicUsageDescription=t}let r="next"in n,i=n.next||{};if("number"==typeof i.revalidate&&(void 0===f.revalidate||"number"==typeof f.revalidate&&i.revalidate<f.revalidate)){let t=f.forceDynamic;if(t&&0===i.revalidate||(f.revalidate=i.revalidate),!t&&0===i.revalidate){let t=`revalidate: ${i.revalidate} fetch ${e}${f.pathname?` ${f.pathname}`:""}`,r=new s(t);f.dynamicUsageErr=r,f.dynamicUsageStack=r.stack,f.dynamicUsageDescription=t}}r&&delete n.next}return M()})},globalThis.fetch.__nextGetStaticStore=()=>t,globalThis.fetch.__nextPatched=!0}({serverHooks:this.serverHooks,staticGenerationAsyncStorage:this.staticGenerationAsyncStorage});let n=await s(a,{params:t.params});t.staticGenerationContext.fetchMetrics=i.fetchMetrics,await Promise.all(i.pendingRevalidates||[]),V(i),t.staticGenerationContext.fetchTags=null==(e=i.tags)?void 0:e.join(",");let o=this.requestAsyncStorage.getStore();if(o&&o.mutableCookies){let e=new Headers(n.headers);if((0,w._5)(e,o.mutableCookies))return new Response(n.body,{status:n.status,statusText:n.statusText,headers:e})}return n})})));if(!(a instanceof Response))return new Response(null,{status:500});if(a.headers.has("x-middleware-rewrite"))throw Error("NextResponse.rewrite() was used in a app route handler, this is not currently supported. Please remove the invocation to continue.");if("1"===a.headers.get("x-middleware-next"))throw Error("NextResponse.next() was used in a app route handler, this is not supported. See here for more info: https://nextjs.org/docs/messages/next-response-next-in-app-route-handler");return a}async handle(e,t){try{let r=await this.execute(e,t);return r}catch(t){let e=function(e){if(X(e)){let t=X(e)?e.digest.split(";",3)[2]:null;if(!t)throw Error("Invariant: Unexpected redirect url format");return function(e,t){let r=new Headers({location:e});return(0,w._5)(r,t),new Response(null,{status:307,headers:r})}(t,e.mutableCookies)}return(null==e?void 0:e.digest)==="NEXT_NOT_FOUND"&&new Response(null,{status:404})}(t);if(!e)throw t;return e}}}},9996:()=>{"getAll"in Headers.prototype||(Headers.prototype.getAll=function(e){if("set-cookie"!==(e=e.toLowerCase()))throw Error("Headers.getAll is only supported for Set-Cookie header");let t=[...this.entries()].filter(([t])=>t===e);return t.map(([,e])=>e)})},8426:(e,t,r)=>{"use strict";let s,i,n;async function a(){if("_ENTRIES"in globalThis&&_ENTRIES.middleware_instrumentation&&_ENTRIES.middleware_instrumentation.register)try{await _ENTRIES.middleware_instrumentation.register()}catch(e){throw e.message=`An error occurred while loading instrumentation hook: ${e.message}`,e}}r.d(t,{a:()=>er});let o=null;function l(){return o||(o=a()),o}function h(e){return`The edge runtime does not support Node.js '${e}' module.
Learn More: https://nextjs.org/docs/messages/node-module-in-edge-runtime`}process!==r.g.process&&(process.env=r.g.process.env,r.g.process=process),Object.defineProperty(globalThis,"__import_unsupported",{value:function(e){let t=new Proxy(function(){},{get(t,r){if("then"===r)return{};throw Error(h(e))},construct(){throw Error(h(e))},apply(r,s,i){if("function"==typeof i[0])return i[0](t);throw Error(h(e))}});return new Proxy({},{get:()=>t})},enumerable:!1,configurable:!1}),l();class c extends Error{constructor({page:e}){super(`The middleware "${e}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class u extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class d extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}var f=r(9351);let p=Symbol("response"),g=Symbol("passThrough"),v=Symbol("waitUntil");class m{constructor(e){this[v]=[],this[g]=!1}respondWith(e){this[p]||(this[p]=Promise.resolve(e))}passThroughOnException(){this[g]=!0}waitUntil(e){this[v].push(e)}}class y extends m{constructor(e){super(e.request),this.sourcePage=e.page}get request(){throw new c({page:this.sourcePage})}respondWith(){throw new c({page:this.sourcePage})}}var b=r(580),_=r(3627);let w=Symbol("internal request");class S extends Request{constructor(e,t={}){let r="string"!=typeof e&&"url"in e?e.url:String(e);(0,f.r4)(r),super(r,t);let s=new b.c(r,{headers:(0,f.lb)(this.headers),nextConfig:t.nextConfig});this[w]={cookies:new _.q(this.headers),geo:t.geo||{},ip:t.ip,nextUrl:s,url:s.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[w].cookies}get geo(){return this[w].geo}get ip(){return this[w].ip}get nextUrl(){return this[w].nextUrl}get page(){throw new u}get ua(){throw new d}get url(){return this[w].url}}var T=r(7845);function x(e,t){let r="string"==typeof t?new URL(t):t,s=new URL(e,t),i=r.protocol+"//"+r.host;return s.protocol+"//"+s.host===i?s.toString().replace(i,""):s.toString()}var E=r(1691);let P=["__nextFallback","__nextLocale","__nextInferredLocaleFromDefault","__nextDefaultLocale","__nextIsNotFound",E.H4],O=["__nextDataReq"];var C=r(821);class R extends S{constructor(e){super(e.input,e.init),this.sourcePage=e.page}get request(){throw new c({page:this.sourcePage})}respondWith(){throw new c({page:this.sourcePage})}waitUntil(){throw new c({page:this.sourcePage})}}let k=[[E.i4],[E.ph],[E.pz],[E.yR]];async function A(e){await l();let t=void 0!==self.__BUILD_MANIFEST;e.request.url=e.request.url.replace(/\.rsc($|\?)/,"$1");let r=new b.c(e.request.url,{headers:e.request.headers,nextConfig:e.request.nextConfig}),s=[...r.searchParams.keys()];for(let e of s){let t=r.searchParams.getAll(e);if(e!==C.dN&&e.startsWith(C.dN)){let s=e.substring(C.dN.length);for(let e of(r.searchParams.delete(s),t))r.searchParams.append(s,e);r.searchParams.delete(e)}}let i=r.buildId;r.buildId="";let n=e.request.headers["x-nextjs-data"];n&&"/index"===r.pathname&&(r.pathname="/");let a=(0,f.EK)(e.request.headers),o=new Map;if(!t)for(let e of k){let t=e.toString().toLowerCase(),r=a.get(t);r&&(o.set(t,a.get(t)),a.delete(t))}let h=new R({page:e.page,input:(function(e,t){let r="string"==typeof e,s=r?new URL(e):e;for(let e of P)s.searchParams.delete(e);if(t)for(let e of O)s.searchParams.delete(e);return r?s.toString():s})(r,!0).toString(),init:{body:e.request.body,geo:e.request.geo,headers:a,ip:e.request.ip,method:e.request.method,nextConfig:e.request.nextConfig,signal:e.request.signal}});n&&Object.defineProperty(h,"__isData",{enumerable:!1,value:!0}),!globalThis.__incrementalCache&&e.IncrementalCache&&(globalThis.__incrementalCache=new e.IncrementalCache({appDir:!0,fetchCache:!0,minimalMode:!0,fetchCacheKeyPrefix:void 0,dev:!1,requestHeaders:e.request.headers,requestProtocol:"https",getPrerenderManifest:()=>({version:-1,routes:{},dynamicRoutes:{},notFoundRoutes:[],preview:{previewModeId:"development-id"}})}));let c=new y({request:h,page:e.page}),u=await e.handler(h,c);if(u&&!(u instanceof Response))throw TypeError("Expected an instance of Response to be returned");let d=null==u?void 0:u.headers.get("x-middleware-rewrite");if(u&&d){let t=new b.c(d,{forceLocale:!0,headers:e.request.headers,nextConfig:e.request.nextConfig});t.host===h.nextUrl.host&&(t.buildId=i||t.buildId,u.headers.set("x-middleware-rewrite",String(t)));let s=x(String(t),String(r));n&&u.headers.set("x-nextjs-rewrite",s)}let p=null==u?void 0:u.headers.get("Location");if(u&&p&&!t){let t=new b.c(p,{forceLocale:!1,headers:e.request.headers,nextConfig:e.request.nextConfig});u=new Response(u.body,u),t.host===h.nextUrl.host&&(t.buildId=i||t.buildId,u.headers.set("Location",String(t))),n&&(u.headers.delete("Location"),u.headers.set("x-nextjs-redirect",x(String(t),String(r))))}let g=u||T.x.next(),m=g.headers.get("x-middleware-override-headers"),_=[];if(m){for(let[e,t]of o)g.headers.set(`x-middleware-request-${e}`,t),_.push(e);_.length>0&&g.headers.set("x-middleware-override-headers",m+","+_.join(","))}return{response:g,waitUntil:Promise.all(c[v])}}var j=r(937),I=r.n(j),N=r(5441),$=r.n(N);let D=e=>{let t=["/"];for(let r of e||[])if(r.startsWith("/")){let e=r.split("/");for(let r=1;r<e.length+1;r++){let s=e.slice(0,r).join("/");s&&(t.push(s),t.includes(s)||t.push(s))}}else t.includes(r)||t.push(r);return t};class L{constructor(e){this.fs=e.fs,this.flushToDisk=e.flushToDisk,this.serverDistDir=e.serverDistDir,this.appDir=!!e._appDir,this.revalidatedTags=e.revalidatedTags,e.maxMemoryCacheSize&&!s&&(s=new(I())({max:e.maxMemoryCacheSize,length({value:e}){var t;if(!e)return 25;if("REDIRECT"===e.kind)return JSON.stringify(e.props).length;if("IMAGE"===e.kind)throw Error("invariant image should not be incremental-cache");return"FETCH"===e.kind?JSON.stringify(e.data||"").length:"ROUTE"===e.kind?e.body.length:e.html.length+((null==(t=JSON.stringify(e.pageData))?void 0:t.length)||0)}})),this.serverDistDir&&this.fs&&(this.tagsManifestPath=$().join(this.serverDistDir,"..","cache","fetch-cache","tags-manifest.json"),this.loadTagsManifest())}loadTagsManifest(){if(this.tagsManifestPath&&this.fs&&!i)try{i=JSON.parse(this.fs.readFileSync(this.tagsManifestPath).toString("utf8"))}catch(e){i={version:1,items:{}}}}async setTags(e,t){if(this.loadTagsManifest(),i&&this.tagsManifestPath){for(let r of t){let t=i.items[r]||{keys:[]};t.keys.includes(e)||t.keys.push(e),i.items[r]=t}try{await this.fs.mkdir($().dirname(this.tagsManifestPath)),await this.fs.writeFile(this.tagsManifestPath,JSON.stringify(i||{}))}catch(e){console.warn("Failed to update tags manifest.",e)}}}async revalidateTag(e){if(this.loadTagsManifest(),!i||!this.tagsManifestPath)return;let t=i.items[e]||{keys:[]};t.revalidatedAt=Date.now(),i.items[e]=t;try{await this.fs.mkdir($().dirname(this.tagsManifestPath)),await this.fs.writeFile(this.tagsManifestPath,JSON.stringify(i||{}))}catch(e){console.warn("Failed to update tags manifest.",e)}}async get(e,t){var r,n,a,o;let l;let h=null==s?void 0:s.get(e);if((null==h?void 0:null==(r=h.value)?void 0:r.kind)==="PAGE"){let e=null==(o=h.value.headers)?void 0:o["x-next-cache-tags"];"string"==typeof e&&(l=e.split(","))}if((null==h?void 0:null==(n=h.value)?void 0:n.kind)==="PAGE"&&(null==l?void 0:l.length)){this.loadTagsManifest();let e=D(l||[]),t=e.some(e=>{var t;return(null==(t=null==i?void 0:i.items[e])?void 0:t.revalidatedAt)&&(null==i?void 0:i.items[e].revalidatedAt)>=((null==h?void 0:h.lastModified)||Date.now())});t&&(h.lastModified=-1)}if(h&&(null==h?void 0:null==(a=h.value)?void 0:a.kind)==="FETCH"){this.loadTagsManifest();let e=h.value.data,t=D(e.tags||[]),r=t.some(e=>{var t;return!!this.revalidatedTags.includes(e)||(null==(t=null==i?void 0:i.items[e])?void 0:t.revalidatedAt)&&(null==i?void 0:i.items[e].revalidatedAt)>=((null==h?void 0:h.lastModified)||Date.now())});r&&(h=void 0)}return h||null}async set(e,t){if(null==s||s.set(e,{value:t,lastModified:Date.now()}),this.flushToDisk){if((null==t?void 0:t.kind)==="ROUTE"){let{filePath:r}=await this.getFsPath({pathname:`${e}.body`,appDir:!0});await this.fs.mkdir($().dirname(r)),await this.fs.writeFile(r,t.body),await this.fs.writeFile(r.replace(/\.body$/,".meta"),JSON.stringify({headers:t.headers,status:t.status}));return}if((null==t?void 0:t.kind)==="PAGE"){let r="string"==typeof t.pageData,{filePath:s}=await this.getFsPath({pathname:`${e}.html`,appDir:r});await this.fs.mkdir($().dirname(s)),await this.fs.writeFile(s,t.html),await this.fs.writeFile((await this.getFsPath({pathname:`${e}.${r?"rsc":"json"}`,appDir:r})).filePath,r?t.pageData:JSON.stringify(t.pageData)),(t.headers||t.status)&&await this.fs.writeFile(s.replace(/\.html$/,".meta"),JSON.stringify({headers:t.headers,status:t.status}))}else if((null==t?void 0:t.kind)==="FETCH"){let{filePath:r}=await this.getFsPath({pathname:e,fetchCache:!0});await this.fs.mkdir($().dirname(r)),await this.fs.writeFile(r,JSON.stringify(t)),await this.setTags(e,t.data.tags||[])}}}async getFsPath({pathname:e,appDir:t,fetchCache:r}){if(r)return{filePath:$().join(this.serverDistDir,"..","cache","fetch-cache",e),isAppPath:!1};let s=$().join(this.serverDistDir,"pages",e);if(!this.appDir||!1===t)return{filePath:s,isAppPath:!1};try{return await this.fs.readFile(s),{filePath:s,isAppPath:!1}}catch(t){return{filePath:$().join(this.serverDistDir,"app",e),isAppPath:!0}}}}let M=/\/\[[^/]+?\](?=\/|$)/,U="undefined"!=typeof performance;U&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class B extends Error{}function H(e){var t;let r=(t=/^\/index(\/|$)/.test(e)&&!M.test(e)?"/index"+e:"/"===e?"/index":e).startsWith("/")?t:"/"+t;return r}let q=0;class G{static isAvailable(e){return!!(e._requestHeaders["x-vercel-sc-host"]||process.env.SUSPENSE_CACHE_URL)}constructor(e){if(this.debug=!!process.env.NEXT_PRIVATE_DEBUG_CACHE,this.headers={},this.revalidatedTags=e.revalidatedTags,this.headers["Content-Type"]="application/json",E.yR in e._requestHeaders){let t=JSON.parse(e._requestHeaders[E.yR]);for(let e in t)this.headers[e]=t[e];delete e._requestHeaders[E.yR]}let t=e._requestHeaders["x-vercel-sc-host"]||process.env.SUSPENSE_CACHE_URL,r=e._requestHeaders["x-vercel-sc-basepath"]||process.env.SUSPENSE_CACHE_BASEPATH;process.env.SUSPENSE_CACHE_AUTH_TOKEN&&(this.headers.Authorization=`Bearer ${process.env.SUSPENSE_CACHE_AUTH_TOKEN}`),t?(this.cacheEndpoint=`https://${t}${r||""}`,this.debug&&console.log("using cache endpoint",this.cacheEndpoint)):this.debug&&console.log("no cache endpoint available"),e.maxMemoryCacheSize?n||(this.debug&&console.log("using memory store for fetch cache"),n=new(I())({max:e.maxMemoryCacheSize,length({value:e}){var t;if(!e)return 25;if("REDIRECT"===e.kind)return JSON.stringify(e.props).length;if("IMAGE"===e.kind)throw Error("invariant image should not be incremental-cache");return"FETCH"===e.kind?JSON.stringify(e.data||"").length:"ROUTE"===e.kind?e.body.length:e.html.length+((null==(t=JSON.stringify(e.pageData))?void 0:t.length)||0)}})):this.debug&&console.log("not using memory store for fetch cache")}async revalidateTag(e){if(this.debug&&console.log("revalidateTag",e),Date.now()<q){this.debug&&console.log("rate limited ",q);return}try{let t=await fetch(`${this.cacheEndpoint}/v1/suspense-cache/revalidate?tags=${e}`,{method:"POST",headers:this.headers,next:{internal:!0}});if(429===t.status){let e=t.headers.get("retry-after")||"60000";q=Date.now()+parseInt(e)}if(!t.ok)throw Error(`Request failed with status ${t.status}.`)}catch(t){console.warn(`Failed to revalidate tag ${e}`,t)}}async get(e,t,r,s){var i;if(!t)return null;if(Date.now()<q)return this.debug&&console.log("rate limited"),null;let a=null==n?void 0:n.get(e);if(Date.now()-((null==a?void 0:a.lastModified)||0)>2e3&&(a=void 0),!a&&this.cacheEndpoint)try{let t=Date.now(),i=await fetch(`${this.cacheEndpoint}/v1/suspense-cache/${e}`,{method:"GET",headers:{...this.headers,"X-Vercel-Cache-Item-Name":r},next:{internal:!0,fetchType:"cache-get",fetchUrl:r,fetchIdx:s}});if(429===i.status){let e=i.headers.get("retry-after")||"60000";q=Date.now()+parseInt(e)}if(404===i.status)return this.debug&&console.log(`no fetch cache entry for ${e}, duration: ${Date.now()-t}ms`),null;if(!i.ok)throw console.error(await i.text()),Error(`invalid response from cache ${i.status}`);let o=await i.json();if(!o||"FETCH"!==o.kind)throw this.debug&&console.log({cached:o}),Error("invalid cache value");let l=i.headers.get("x-vercel-cache-state"),h=i.headers.get("age");a={value:o,lastModified:"fresh"!==l?Date.now()-C.BR:Date.now()-1e3*parseInt(h||"0",10)},this.debug&&console.log(`got fetch cache entry for ${e}, duration: ${Date.now()-t}ms, size: ${Object.keys(o).length}, cache-state: ${l}`),a&&(null==n||n.set(e,a))}catch(e){this.debug&&console.error("Failed to get from fetch-cache",e)}if((null==a?void 0:null==(i=a.value)?void 0:i.kind)==="FETCH"){let e=a.value.data,t=D(e.tags||[]);t.some(e=>this.revalidatedTags.includes(e))&&(a=void 0)}return a||null}async set(e,t,r,s,i){if(r){if(Date.now()<q){this.debug&&console.log("rate limited");return}if(null==n||n.set(e,{value:t,lastModified:Date.now()}),this.cacheEndpoint)try{let r=Date.now();null!==t&&"revalidate"in t&&(this.headers["x-vercel-revalidate"]=t.revalidate.toString()),!this.headers["x-vercel-revalidate"]&&null!==t&&"data"in t&&(this.headers["x-vercel-cache-control"]=t.data.headers["cache-control"]);let n=JSON.stringify(t),a={...this.headers};null!==t&&"data"in t&&t.data.tags&&(a["x-vercel-cache-tags"]=t.data.tags.join(",")),this.debug&&console.log("set cache",e,{tags:a["x-vercel-cache-tags"]});let o=await fetch(`${this.cacheEndpoint}/v1/suspense-cache/${e}`,{method:"POST",headers:{...a,"X-Vercel-Cache-Item-Name":s||""},body:n,next:{internal:!0,fetchType:"cache-set",fetchUrl:s,fetchIdx:i}});if(429===o.status){let e=o.headers.get("retry-after")||"60000";q=Date.now()+parseInt(e)}if(!o.ok)throw this.debug&&console.log(await o.text()),Error(`invalid response ${o.status}`);this.debug&&console.log(`successfully set to fetch-cache for ${e}, duration: ${Date.now()-r}ms, size: ${n.length}`)}catch(e){this.debug&&console.error("Failed to update fetch cache",e)}}}}var F=r(8135);function V(e){return new TextEncoder().encode(e)}function z(e){return e.replace(/\/$/,"").replace(/\/index$/,"")||"/"}class K{constructor({fs:e,dev:t,appDir:r,flushToDisk:s,fetchCache:i,minimalMode:n,serverDistDir:a,requestHeaders:o,requestProtocol:l,maxMemoryCacheSize:h,getPrerenderManifest:c,fetchCacheKeyPrefix:u,CurCacheHandler:d,allowedRevalidateHeaderKeys:f}){var p,g,v,m;let y=!!process.env.NEXT_PRIVATE_DEBUG_CACHE;d?y&&console.log("using custom cache handler",d.name):(e&&a&&(y&&console.log("using filesystem cache handler"),d=L),G.isAvailable({_requestHeaders:o})&&n&&i&&(y&&console.log("using fetch cache handler"),d=G)),process.env.__NEXT_TEST_MAX_ISR_CACHE&&(h=parseInt(process.env.__NEXT_TEST_MAX_ISR_CACHE,10)),this.dev=t,this.minimalMode=n,this.requestHeaders=o,this.requestProtocol=l,this.allowedRevalidateHeaderKeys=f,this.prerenderManifest=c(),this.fetchCacheKeyPrefix=u;let b=[];o[C.y3]===(null==(p=this.prerenderManifest)?void 0:null==(g=p.preview)?void 0:g.previewModeId)&&(this.isOnDemandRevalidate=!0),n&&"string"==typeof o["x-next-revalidated-tags"]&&o["x-next-revalidate-tag-token"]===(null==(v=this.prerenderManifest)?void 0:null==(m=v.preview)?void 0:m.previewModeId)&&(b=o["x-next-revalidated-tags"].split(",")),d&&(this.cacheHandler=new d({dev:t,fs:e,flushToDisk:s,serverDistDir:a,revalidatedTags:b,maxMemoryCacheSize:h,_appDir:!!r,_requestHeaders:o,fetchCacheKeyPrefix:u}))}calculateRevalidate(e,t,r){if(r)return new Date().getTime()-1e3;let{initialRevalidateSeconds:s}=this.prerenderManifest.routes[z(e)]||{initialRevalidateSeconds:1};return"number"==typeof s?1e3*s+t:s}_getPathname(e,t){return t?e:H(e)}async revalidateTag(e){var t;return null==(t=this.cacheHandler)?void 0:null==t.revalidateTag?void 0:t.revalidateTag(e)}async fetchCacheKey(e,t={}){let r;let s=[];if(t.body){if("function"==typeof t.body.getReader){let e=t.body,r=e.getReader(),i=new Uint8Array;await r.read().then(function e({done:t,value:n}){if(!t){if(n)try{s.push("string"==typeof n?n:(0,F.encode)(n));let e="string"==typeof n?V(n):new Uint8Array(n),t=i;(i=new Uint8Array(t.byteLength+e.byteLength)).set(t),i.set(e,t.byteLength)}catch(e){console.error(e)}r.read().then(e)}}),t._ogBody=i}else if("function"==typeof t.body.keys){let e=t.body;for(let r of(t._ogBody=t.body,new Set([...e.keys()]))){let t=e.getAll(r);s.push(`${r}=${(await Promise.all(t.map(async e=>"string"==typeof e?e:await e.text()))).join(",")}`)}}else if("function"==typeof t.body.arrayBuffer){let e=t.body,r=await e.arrayBuffer();s.push((0,F.encode)(await t.body.arrayBuffer())),t._ogBody=new Blob([r],{type:e.type})}else"string"==typeof t.body&&(s.push(t.body),t._ogBody=t.body)}let i=JSON.stringify(["v3",this.fetchCacheKeyPrefix||"",e,t.method,"function"==typeof(t.headers||{}).keys?Object.fromEntries(t.headers):t.headers,t.mode,t.redirect,t.credentials,t.referrer,t.referrerPolicy,t.integrity,t.cache,s]);{var n;let e=V(i);n=await crypto.subtle.digest("SHA-256",e),r=Array.prototype.map.call(new Uint8Array(n),e=>e.toString(16).padStart(2,"0")).join("")}return r}async get(e,t,r,s,i){var n,a,o;let l,h;if(this.dev&&(!t||"no-cache"===this.requestHeaders["cache-control"]))return null;e=this._getPathname(e,t);let c=null,u=await (null==(n=this.cacheHandler)?void 0:n.get(e,t,s,i));if((null==u?void 0:null==(a=u.value)?void 0:a.kind)==="FETCH"){r=r||u.value.revalidate;let e=Math.round((Date.now()-(u.lastModified||0))/1e3),t=e>r,s=u.value.data;return{isStale:t,value:{kind:"FETCH",data:s,revalidate:r},revalidateAfter:Date.now()+1e3*r}}let d=null==(o=this.prerenderManifest.routes[z(e)])?void 0:o.initialRevalidateSeconds;return(null==u?void 0:u.lastModified)===-1?(l=-1,h=-1*C.BR):l=!!(!1!==(h=this.calculateRevalidate(e,(null==u?void 0:u.lastModified)||Date.now(),this.dev&&!t))&&h<Date.now())||void 0,u&&(c={isStale:l,curRevalidate:d,revalidateAfter:h,value:u.value}),!u&&this.prerenderManifest.notFoundRoutes.includes(e)&&(c={isStale:l,value:null,curRevalidate:d,revalidateAfter:h},this.set(e,c.value,d,t,s,i)),c}async set(e,t,r,s,i,n){if(!this.dev||s){if(s&&JSON.stringify(t).length>2097152){if(this.dev)throw Error("fetch for over 2MB of data can not be cached");return}e=this._getPathname(e,s);try{var a;void 0===r||s||(this.prerenderManifest.routes[e]={dataRoute:$().posix.join("/_next/data",`${H(e)}.json`),srcRoute:null,initialRevalidateSeconds:r}),await (null==(a=this.cacheHandler)?void 0:a.set(e,t,s,i,n))}catch(t){console.warn("Failed to update prerender cache for",e,t)}}}}let J=["(..)(..)","(.)","(..)","(...)"],W=/[|\\{}()[\]^$+*?.-]/,X=/[|\\{}()[\]^$+*?.-]/g;function Y(e){return W.test(e)?e.replace(X,"\\$&"):e}var Q=r(5640);function Z(e){let t=e.startsWith("[")&&e.endsWith("]");t&&(e=e.slice(1,-1));let r=e.startsWith("...");return r&&(e=e.slice(3)),{key:e,repeat:r,optional:t}}class ee{constructor(e){var t;this.definition=e,t=e.pathname,M.test(t)&&(this.dynamic=function(e){let{re:t,groups:r}=e;return e=>{let s=t.exec(e);if(!s)return!1;let i=e=>{try{return decodeURIComponent(e)}catch(e){throw new B("failed to decode param")}},n={};return Object.keys(r).forEach(e=>{let t=r[e],a=s[t.pos];void 0!==a&&(n[e]=~a.indexOf("/")?a.split("/").map(e=>i(e)):t.repeat?[i(a)]:i(a))}),n}}(function(e){let{parameterizedRoute:t,groups:r}=function(e){let t=(0,Q.Q)(e).slice(1).split("/"),r={},s=1;return{parameterizedRoute:t.map(e=>{let t=J.find(t=>e.startsWith(t)),i=e.match(/\[((?:\[.*\])|.+)\]/);if(t&&i){let{key:e,optional:n,repeat:a}=Z(i[1]);return r[e]={pos:s++,repeat:a,optional:n},"/"+Y(t)+"([^/]+?)"}if(!i)return"/"+Y(e);{let{key:e,repeat:t,optional:n}=Z(i[1]);return r[e]={pos:s++,repeat:t,optional:n},t?n?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)"}}).join(""),groups:r}}(e);return{re:RegExp("^"+t+"(?:/)?$"),groups:r}}(e.pathname)))}get identity(){return this.definition.pathname}get isDynamic(){return void 0!==this.dynamic}match(e){let t=this.test(e);return t?{definition:this.definition,params:t.params}:null}test(e){if(this.dynamic){let t=this.dynamic(e);return t?{params:t}:null}return e===this.definition.pathname?{}:null}}var et=r(1635);class er{constructor(e){this.routeModule=e,this.matcher=new ee(e.definition)}static wrap(e,t={}){let r=new er(e);return e=>A({...e,...t,IncrementalCache:K,handler:r.handler.bind(r)})}async handler(e){let t=(0,Q.Q)(new URL(e.url).pathname),{basePath:r}=e.nextUrl;r&&(t=(0,et.n)(t,r));let s=this.matcher.match(t);if(!s)throw Error(`Invariant: no match found for request. Pathname '${t}' should have matched '${this.matcher.definition.pathname}'`);let i={params:s.params,prerenderManifest:{version:4,routes:{},dynamicRoutes:{},preview:{previewModeEncryptionKey:"",previewModeId:"",previewModeSigningKey:""},notFoundRoutes:[]},staticGenerationContext:{supportsDynamicHTML:!0}};return await this.routeModule.handle(e,i)}}},5459:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s.x});var s=r(7845)},580:(e,t,r)=>{"use strict";r.d(t,{c:()=>d});var s=r(5640),i=r(389);function n(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:s,hash:n}=(0,i.c)(e);return""+t+r+s+n}function a(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:s,hash:n}=(0,i.c)(e);return""+r+t+s+n}var o=r(9044),l=r(1635);let h=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|::1|localhost)/;function c(e,t){return new URL(String(e).replace(h,"localhost"),t&&String(t).replace(h,"localhost"))}let u=Symbol("NextURLInternal");class d{constructor(e,t,r){let s,i;"object"==typeof t&&"pathname"in t||"string"==typeof t?(s=t,i=r||{}):i=r||t||{},this[u]={url:c(e,s??i.base),options:i,basePath:""},this.analyze()}analyze(){var e,t,r,s,i;let n=function(e,t){var r,s,i;let{basePath:n,i18n:a,trailingSlash:h}=null!=(r=t.nextConfig)?r:{},c={pathname:e,trailingSlash:"/"!==e?e.endsWith("/"):h};if(n&&(0,o.Y)(c.pathname,n)&&(c.pathname=(0,l.n)(c.pathname,n),c.basePath=n),!0===t.parseData&&c.pathname.startsWith("/_next/data/")&&c.pathname.endsWith(".json")){let e=c.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),t=e[0];c.pathname="index"!==e[1]?"/"+e.slice(1).join("/"):"/",c.buildId=t}if(t.i18nProvider){let e=t.i18nProvider.analyze(c.pathname);c.locale=e.detectedLocale,c.pathname=null!=(s=e.pathname)?s:c.pathname}else if(a){let e=function(e,t){let r;let s=e.split("/");return(t||[]).some(t=>!!s[1]&&s[1].toLowerCase()===t.toLowerCase()&&(r=t,s.splice(1,1),e=s.join("/")||"/",!0)),{pathname:e,detectedLocale:r}}(c.pathname,a.locales);c.locale=e.detectedLocale,c.pathname=null!=(i=e.pathname)?i:c.pathname}return c}(this[u].url.pathname,{nextConfig:this[u].options.nextConfig,parseData:!0,i18nProvider:this[u].options.i18nProvider}),a=function(e,t){let r;if((null==t?void 0:t.host)&&!Array.isArray(t.host))r=t.host.toString().split(":")[0];else{if(!e.hostname)return;r=e.hostname}return r.toLowerCase()}(this[u].url,this[u].options.headers);this[u].domainLocale=this[u].options.i18nProvider?this[u].options.i18nProvider.detectDomainLocale(a):function(e,t,r){if(e)for(let n of(r&&(r=r.toLowerCase()),e)){var s,i;let e=null==(s=n.domain)?void 0:s.split(":")[0].toLowerCase();if(t===e||r===n.defaultLocale.toLowerCase()||(null==(i=n.locales)?void 0:i.some(e=>e.toLowerCase()===r)))return n}}(null==(e=this[u].options.nextConfig)?void 0:null==(t=e.i18n)?void 0:t.domains,a);let h=(null==(r=this[u].domainLocale)?void 0:r.defaultLocale)||(null==(s=this[u].options.nextConfig)?void 0:null==(i=s.i18n)?void 0:i.defaultLocale);this[u].url.pathname=n.pathname,this[u].defaultLocale=h,this[u].basePath=n.basePath??"",this[u].buildId=n.buildId,this[u].locale=n.locale??h,this[u].trailingSlash=n.trailingSlash}formatPathname(){var e;let t;return t=function(e,t,r,s){if(!t||t===r)return e;let i=e.toLowerCase();return!s&&((0,o.Y)(i,"/api")||(0,o.Y)(i,"/"+t.toLowerCase()))?e:n(e,"/"+t)}((e={basePath:this[u].basePath,buildId:this[u].buildId,defaultLocale:this[u].options.forceLocale?void 0:this[u].defaultLocale,locale:this[u].locale,pathname:this[u].url.pathname,trailingSlash:this[u].trailingSlash}).pathname,e.locale,e.buildId?void 0:e.defaultLocale,e.ignorePrefix),(e.buildId||!e.trailingSlash)&&(t=(0,s.Q)(t)),e.buildId&&(t=a(n(t,"/_next/data/"+e.buildId),"/"===e.pathname?"index.json":".json")),t=n(t,e.basePath),!e.buildId&&e.trailingSlash?t.endsWith("/")?t:a(t,"/"):(0,s.Q)(t)}formatSearch(){return this[u].url.search}get buildId(){return this[u].buildId}set buildId(e){this[u].buildId=e}get locale(){return this[u].locale??""}set locale(e){var t,r;if(!this[u].locale||!(null==(t=this[u].options.nextConfig)?void 0:null==(r=t.i18n)?void 0:r.locales.includes(e)))throw TypeError(`The NextURL configuration includes no locale "${e}"`);this[u].locale=e}get defaultLocale(){return this[u].defaultLocale}get domainLocale(){return this[u].domainLocale}get searchParams(){return this[u].url.searchParams}get host(){return this[u].url.host}set host(e){this[u].url.host=e}get hostname(){return this[u].url.hostname}set hostname(e){this[u].url.hostname=e}get port(){return this[u].url.port}set port(e){this[u].url.port=e}get protocol(){return this[u].url.protocol}set protocol(e){this[u].url.protocol=e}get href(){let e=this.formatPathname(),t=this.formatSearch();return`${this.protocol}//${this.host}${e}${t}${this.hash}`}set href(e){this[u].url=c(e),this.analyze()}get origin(){return this[u].url.origin}get pathname(){return this[u].url.pathname}set pathname(e){this[u].url.pathname=e}get hash(){return this[u].url.hash}set hash(e){this[u].url.hash=e}get search(){return this[u].url.search}set search(e){this[u].url.search=e}get password(){return this[u].url.password}set password(e){this[u].url.password=e}get username(){return this[u].url.username}set username(e){this[u].url.username=e}get basePath(){return this[u].basePath}set basePath(e){this[u].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new d(String(this),this[u].options)}}},9183:(e,t,r)=>{"use strict";r.d(t,{h:()=>n});var s=r(6291);class i extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new i}}class n extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,i){if("symbol"==typeof r)return s.g.get(t,r,i);let n=r.toLowerCase(),a=Object.keys(e).find(e=>e.toLowerCase()===n);if(void 0!==a)return s.g.get(t,a,i)},set(t,r,i,n){if("symbol"==typeof r)return s.g.set(t,r,i,n);let a=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===a);return s.g.set(t,o??r,i,n)},has(t,r){if("symbol"==typeof r)return s.g.has(t,r);let i=r.toLowerCase(),n=Object.keys(e).find(e=>e.toLowerCase()===i);return void 0!==n&&s.g.has(t,n)},deleteProperty(t,r){if("symbol"==typeof r)return s.g.deleteProperty(t,r);let i=r.toLowerCase(),n=Object.keys(e).find(e=>e.toLowerCase()===i);return void 0===n||s.g.deleteProperty(t,n)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return i.callable;default:return s.g.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new n(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,s]of this.entries())e.call(t,s,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},6291:(e,t,r)=>{"use strict";r.d(t,{g:()=>s});class s{static get(e,t,r){let s=Reflect.get(e,t,r);return"function"==typeof s?s.bind(e):s}static set(e,t,r,s){return Reflect.set(e,t,r,s)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},9375:(e,t,r)=>{"use strict";r.d(t,{Qb:()=>a,_5:()=>l,vr:()=>h});var s=r(3627),i=r(6291);class n extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new n}}class a{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return n.callable;default:return i.g.get(e,t,r)}}})}}let o=Symbol.for("next.mutated.cookies");function l(e,t){let r=function(e){let t=e[o];return t&&Array.isArray(t)&&0!==t.length?t:[]}(t);if(0===r.length)return!1;let i=new s.n(e),n=i.getAll();for(let e of r)i.set(e);for(let e of n)i.set(e);return!0}class h{static wrap(e,t){let r=new s.n(new Headers);for(let t of e.getAll())r.set(t);let n=[],a=new Set,l=()=>{var e;let i=null==fetch.__nextGetStaticStore?void 0:null==(e=fetch.__nextGetStaticStore())?void 0:e.getStore();i&&(i.pathWasRevalidated=!0);let o=r.getAll();if(n=o.filter(e=>a.has(e.name)),t){let e=[];for(let t of n){let r=new s.n(new Headers);r.set(t),e.push(r.toString())}t.setHeader("Set-Cookie",e)}};return new Proxy(r,{get(e,t,r){switch(t){case o:return n;case"delete":return function(...t){a.add("string"==typeof t[0]?t[0]:t[0].name);try{e.delete(...t)}finally{l()}};case"set":return function(...t){a.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t)}finally{l()}};default:return i.g.get(e,t,r)}}})}}},3627:(e,t,r)=>{"use strict";r.d(t,{n:()=>s.ResponseCookies,q:()=>s.RequestCookies});var s=r(3928)},7845:(e,t,r)=>{"use strict";r.d(t,{x:()=>h});var s=r(580),i=r(9351),n=r(3627);let a=Symbol("internal response"),o=new Set([301,302,303,307,308]);function l(e,t){var r;if(null==e?void 0:null==(r=e.request)?void 0:r.headers){if(!(e.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let r=[];for(let[s,i]of e.request.headers)t.set("x-middleware-request-"+s,i),r.push(s);t.set("x-middleware-override-headers",r.join(","))}}class h extends Response{constructor(e,t={}){super(e,t),this[a]={cookies:new n.n(this.headers),url:t.url?new s.c(t.url,{headers:(0,i.lb)(this.headers),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[a].cookies}static json(e,t){let r=Response.json(e,t);return new h(r.body,r)}static redirect(e,t){let r="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!o.has(r))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let s="object"==typeof t?t:{},n=new Headers(null==s?void 0:s.headers);return n.set("Location",(0,i.r4)(e)),new h(null,{...s,headers:n,status:r})}static rewrite(e,t){let r=new Headers(null==t?void 0:t.headers);return r.set("x-middleware-rewrite",(0,i.r4)(e)),l(t,r),new h(null,{...t,headers:r})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),l(e,t),new h(null,{...e,headers:t})}}},9351:(e,t,r)=>{"use strict";function s(e){let t=new Headers;for(let[r,s]of Object.entries(e)){let e=Array.isArray(s)?s:[s];for(let s of e)void 0!==s&&("number"==typeof s&&(s=s.toString()),t.append(r,s))}return t}function i(e){let t={},r=[];if(e)for(let[s,i]of e.entries())"set-cookie"===s.toLowerCase()?(r.push(...function(e){var t,r,s,i,n,a=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,n=!1;l();)if(","===(r=e.charAt(o))){for(s=o,o+=1,l(),i=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(n=!0,o=i,a.push(e.substring(t,s)),t=o):o=s+1}else o+=1;(!n||o>=e.length)&&a.push(e.substring(t,e.length))}return a}(i)),t[s]=1===r.length?r[0]:r):t[s]=i;return t}function n(e){try{return String(new URL(String(e)))}catch(t){throw Error(`URL is malformed "${String(e)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:t})}}r.d(t,{EK:()=>s,lb:()=>i,r4:()=>n})},8135:(e,t,r)=>{"use strict";r.r(t),r.d(t,{decode:()=>a,encode:()=>n});let s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<s.length;e++)i[s.charCodeAt(e)]=e;let n=e=>{let t=new Uint8Array(e),r,i=t.length,n="";for(r=0;r<i;r+=3)n+=s[t[r]>>2]+s[(3&t[r])<<4|t[r+1]>>4]+s[(15&t[r+1])<<2|t[r+2]>>6]+s[63&t[r+2]];return i%3==2?n=n.substring(0,n.length-1)+"=":i%3==1&&(n=n.substring(0,n.length-2)+"=="),n},a=e=>{let t=.75*e.length,r=e.length,s,n=0,a,o,l,h;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);let c=new ArrayBuffer(t),u=new Uint8Array(c);for(s=0;s<r;s+=4)a=i[e.charCodeAt(s)],o=i[e.charCodeAt(s+1)],l=i[e.charCodeAt(s+2)],h=i[e.charCodeAt(s+3)],u[n++]=a<<2|o>>4,u[n++]=(15&o)<<4|l>>2,u[n++]=(3&l)<<6|63&h;return c}},5441:(e,t,r)=>{"use strict";let s;s=r(9368),e.exports=s},389:(e,t,r)=>{"use strict";function s(e){let t=e.indexOf("#"),r=e.indexOf("?"),s=r>-1&&(t<0||r<t);return s||t>-1?{pathname:e.substring(0,s?r:t),query:s?e.substring(r,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}r.d(t,{c:()=>s})},9044:(e,t,r)=>{"use strict";r.d(t,{Y:()=>i});var s=r(389);function i(e,t){if("string"!=typeof e)return!1;let{pathname:r}=(0,s.c)(e);return r===t||r.startsWith(t+"/")}},1635:(e,t,r)=>{"use strict";r.d(t,{n:()=>i});var s=r(9044);function i(e,t){if(!(0,s.Y)(e,t))return e;let r=e.slice(t.length);return r.startsWith("/")?r:"/"+r}},5640:(e,t,r)=>{"use strict";function s(e){return e.replace(/\/$/,"")||"/"}r.d(t,{Q:()=>s})},8104:(e,t,r)=>{"use strict";if("object"==typeof globalThis)s=globalThis;else try{s=r(4178)}catch(e){}finally{if(!s)throw Error("Could not determine global this")}var s,i=s.WebSocket||s.MozWebSocket,n=r(7661);function a(e,t){return t?new i(e,t):new i(e)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(e){Object.defineProperty(a,e,{get:function(){return i[e]}})}),e.exports={w3cwebsocket:i?a:null,version:n}},7661:(e,t,r)=>{"use strict";e.exports=r(9046).version},5430:(e,t,r)=>{"use strict";r.r(t),r.d(t,{actionAsyncStorage:()=>i});var s=r(8791);let i=(0,s.P)()},8791:(e,t,r)=>{"use strict";r.d(t,{P:()=>a});let s=Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available");class i{disable(){throw s}getStore(){}run(){throw s}exit(){throw s}enterWith(){throw s}}let n=globalThis.AsyncLocalStorage;function a(){return n?new n:new i}},533:(e,t,r)=>{"use strict";r.r(t),r.d(t,{requestAsyncStorage:()=>i});var s=r(8791);let i=(0,s.P)()},5948:(e,t,r)=>{"use strict";r.r(t),r.d(t,{staticGenerationAsyncStorage:()=>i});var s=r(8791);let i=(0,s.P)()},723:(e,t,r)=>{"use strict";r.d(t,{wn:()=>i}),((e,t=21)=>(r=t)=>{let s="",i=r;for(;i--;)s+=e[Math.random()*e.length|0];return s})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",7);var s={text:0,function_call:1,data:2};Symbol("internal_openai_fn_messages");var i=class extends Response{constructor(e,t,r){let s=e;r&&(s=e.pipeThrough(r.stream)),super(s,{...t,status:200,headers:{"Content-Type":"text/plain; charset=utf-8","X-Experimental-Stream-Data":r?"true":"false",...null==t?void 0:t.headers}})}};new TextDecoder("utf-8")},9046:e=>{"use strict";e.exports={version:"1.0.34"}}},e=>{var t=e(e.s=8491);(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/chat/route"]=t}]);
//# sourceMappingURL=route.js.map